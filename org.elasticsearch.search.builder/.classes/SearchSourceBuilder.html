


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: SearchSourceBuilder</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">org.elasticsearch.search.builder</a> ]
</div>

<h1>Coverage Summary for Class: SearchSourceBuilder (org.elasticsearch.search.builder)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SearchSourceBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/ 1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    1.1%
  </span>
  <span class="absValue">
    (1/ 88)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    5.6%
  </span>
  <span class="absValue">
    (34/ 606)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;/*
<i>2</i>&nbsp; * Licensed to Elasticsearch under one or more contributor
<i>3</i>&nbsp; * license agreements. See the NOTICE file distributed with
<i>4</i>&nbsp; * this work for additional information regarding copyright
<i>5</i>&nbsp; * ownership. Elasticsearch licenses this file to you under
<i>6</i>&nbsp; * the Apache License, Version 2.0 (the &quot;License&quot;); you may
<i>7</i>&nbsp; * not use this file except in compliance with the License.
<i>8</i>&nbsp; * You may obtain a copy of the License at
<i>9</i>&nbsp; *
<i>10</i>&nbsp; *    http://www.apache.org/licenses/LICENSE-2.0
<i>11</i>&nbsp; *
<i>12</i>&nbsp; * Unless required by applicable law or agreed to in writing,
<i>13</i>&nbsp; * software distributed under the License is distributed on an
<i>14</i>&nbsp; * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
<i>15</i>&nbsp; * KIND, either express or implied.  See the License for the
<i>16</i>&nbsp; * specific language governing permissions and limitations
<i>17</i>&nbsp; * under the License.
<i>18</i>&nbsp; */
<i>19</i>&nbsp;
<i>20</i>&nbsp;package org.elasticsearch.search.builder;
<i>21</i>&nbsp;
<i>22</i>&nbsp;import org.apache.logging.log4j.LogManager;
<i>23</i>&nbsp;import org.elasticsearch.ElasticsearchException;
<i>24</i>&nbsp;import org.elasticsearch.Version;
<i>25</i>&nbsp;import org.elasticsearch.common.Booleans;
<i>26</i>&nbsp;import org.elasticsearch.common.Nullable;
<i>27</i>&nbsp;import org.elasticsearch.common.ParseField;
<i>28</i>&nbsp;import org.elasticsearch.common.ParsingException;
<i>29</i>&nbsp;import org.elasticsearch.common.Strings;
<i>30</i>&nbsp;import org.elasticsearch.common.io.stream.StreamInput;
<i>31</i>&nbsp;import org.elasticsearch.common.io.stream.StreamOutput;
<i>32</i>&nbsp;import org.elasticsearch.common.io.stream.Writeable;
<i>33</i>&nbsp;import org.elasticsearch.common.logging.DeprecationLogger;
<i>34</i>&nbsp;import org.elasticsearch.common.unit.TimeValue;
<i>35</i>&nbsp;import org.elasticsearch.common.xcontent.ToXContentFragment;
<i>36</i>&nbsp;import org.elasticsearch.common.xcontent.ToXContentObject;
<i>37</i>&nbsp;import org.elasticsearch.common.xcontent.XContentBuilder;
<i>38</i>&nbsp;import org.elasticsearch.common.xcontent.XContentHelper;
<i>39</i>&nbsp;import org.elasticsearch.common.xcontent.XContentParser;
<i>40</i>&nbsp;import org.elasticsearch.common.xcontent.XContentType;
<i>41</i>&nbsp;import org.elasticsearch.index.query.QueryBuilder;
<i>42</i>&nbsp;import org.elasticsearch.index.query.QueryRewriteContext;
<i>43</i>&nbsp;import org.elasticsearch.index.query.Rewriteable;
<i>44</i>&nbsp;import org.elasticsearch.script.Script;
<i>45</i>&nbsp;import org.elasticsearch.search.SearchExtBuilder;
<i>46</i>&nbsp;import org.elasticsearch.search.aggregations.AggregationBuilder;
<i>47</i>&nbsp;import org.elasticsearch.search.aggregations.AggregatorFactories;
<i>48</i>&nbsp;import org.elasticsearch.search.aggregations.PipelineAggregationBuilder;
<i>49</i>&nbsp;import org.elasticsearch.search.collapse.CollapseBuilder;
<i>50</i>&nbsp;import org.elasticsearch.search.fetch.StoredFieldsContext;
<i>51</i>&nbsp;import org.elasticsearch.search.fetch.subphase.DocValueFieldsContext.FieldAndFormat;
<i>52</i>&nbsp;import org.elasticsearch.search.fetch.subphase.FetchSourceContext;
<i>53</i>&nbsp;import org.elasticsearch.search.fetch.subphase.highlight.HighlightBuilder;
<i>54</i>&nbsp;import org.elasticsearch.search.internal.SearchContext;
<i>55</i>&nbsp;import org.elasticsearch.search.rescore.RescorerBuilder;
<i>56</i>&nbsp;import org.elasticsearch.search.searchafter.SearchAfterBuilder;
<i>57</i>&nbsp;import org.elasticsearch.search.slice.SliceBuilder;
<i>58</i>&nbsp;import org.elasticsearch.search.sort.ScoreSortBuilder;
<i>59</i>&nbsp;import org.elasticsearch.search.sort.SortBuilder;
<i>60</i>&nbsp;import org.elasticsearch.search.sort.SortBuilders;
<i>61</i>&nbsp;import org.elasticsearch.search.sort.SortOrder;
<i>62</i>&nbsp;import org.elasticsearch.search.suggest.SuggestBuilder;
<i>63</i>&nbsp;
<i>64</i>&nbsp;import java.io.IOException;
<i>65</i>&nbsp;import java.util.ArrayList;
<i>66</i>&nbsp;import java.util.Collections;
<i>67</i>&nbsp;import java.util.List;
<i>68</i>&nbsp;import java.util.Objects;
<i>69</i>&nbsp;import java.util.stream.Collectors;
<i>70</i>&nbsp;
<i>71</i>&nbsp;import static org.elasticsearch.index.query.AbstractQueryBuilder.parseInnerQueryBuilder;
<i>72</i>&nbsp;import static org.elasticsearch.search.internal.SearchContext.TRACK_TOTAL_HITS_ACCURATE;
<i>73</i>&nbsp;import static org.elasticsearch.search.internal.SearchContext.TRACK_TOTAL_HITS_DISABLED;
<i>74</i>&nbsp;
<i>75</i>&nbsp;/**
<i>76</i>&nbsp; * A search source builder allowing to easily build search source. Simple
<i>77</i>&nbsp; * construction using
<i>78</i>&nbsp; * {@link org.elasticsearch.search.builder.SearchSourceBuilder#searchSource()}.
<i>79</i>&nbsp; *
<i>80</i>&nbsp; * @see org.elasticsearch.action.search.SearchRequest#source(SearchSourceBuilder)
<i>81</i>&nbsp; */
<b class="fc"><i>82</i>&nbsp;public final class SearchSourceBuilder implements Writeable, ToXContentObject, Rewriteable&lt;SearchSourceBuilder&gt; {</b>
<b class="fc"><i>83</i>&nbsp;    private static final DeprecationLogger deprecationLogger =</b>
<b class="fc"><i>84</i>&nbsp;        new DeprecationLogger(LogManager.getLogger(SearchSourceBuilder.class));</b>
<i>85</i>&nbsp;
<b class="fc"><i>86</i>&nbsp;    public static final ParseField FROM_FIELD = new ParseField(&quot;from&quot;);</b>
<b class="fc"><i>87</i>&nbsp;    public static final ParseField SIZE_FIELD = new ParseField(&quot;size&quot;);</b>
<b class="fc"><i>88</i>&nbsp;    public static final ParseField TIMEOUT_FIELD = new ParseField(&quot;timeout&quot;);</b>
<b class="fc"><i>89</i>&nbsp;    public static final ParseField TERMINATE_AFTER_FIELD = new ParseField(&quot;terminate_after&quot;);</b>
<b class="fc"><i>90</i>&nbsp;    public static final ParseField QUERY_FIELD = new ParseField(&quot;query&quot;);</b>
<b class="fc"><i>91</i>&nbsp;    public static final ParseField POST_FILTER_FIELD = new ParseField(&quot;post_filter&quot;);</b>
<b class="fc"><i>92</i>&nbsp;    public static final ParseField MIN_SCORE_FIELD = new ParseField(&quot;min_score&quot;);</b>
<b class="fc"><i>93</i>&nbsp;    public static final ParseField VERSION_FIELD = new ParseField(&quot;version&quot;);</b>
<b class="fc"><i>94</i>&nbsp;    public static final ParseField SEQ_NO_PRIMARY_TERM_FIELD = new ParseField(&quot;seq_no_primary_term&quot;);</b>
<b class="fc"><i>95</i>&nbsp;    public static final ParseField EXPLAIN_FIELD = new ParseField(&quot;explain&quot;);</b>
<b class="fc"><i>96</i>&nbsp;    public static final ParseField _SOURCE_FIELD = new ParseField(&quot;_source&quot;);</b>
<b class="fc"><i>97</i>&nbsp;    public static final ParseField STORED_FIELDS_FIELD = new ParseField(&quot;stored_fields&quot;);</b>
<b class="fc"><i>98</i>&nbsp;    public static final ParseField DOCVALUE_FIELDS_FIELD = new ParseField(&quot;docvalue_fields&quot;);</b>
<b class="fc"><i>99</i>&nbsp;    public static final ParseField SCRIPT_FIELDS_FIELD = new ParseField(&quot;script_fields&quot;);</b>
<b class="fc"><i>100</i>&nbsp;    public static final ParseField SCRIPT_FIELD = new ParseField(&quot;script&quot;);</b>
<b class="fc"><i>101</i>&nbsp;    public static final ParseField IGNORE_FAILURE_FIELD = new ParseField(&quot;ignore_failure&quot;);</b>
<b class="fc"><i>102</i>&nbsp;    public static final ParseField SORT_FIELD = new ParseField(&quot;sort&quot;);</b>
<b class="fc"><i>103</i>&nbsp;    public static final ParseField TRACK_SCORES_FIELD = new ParseField(&quot;track_scores&quot;);</b>
<b class="fc"><i>104</i>&nbsp;    public static final ParseField TRACK_TOTAL_HITS_FIELD = new ParseField(&quot;track_total_hits&quot;);</b>
<b class="fc"><i>105</i>&nbsp;    public static final ParseField INDICES_BOOST_FIELD = new ParseField(&quot;indices_boost&quot;);</b>
<b class="fc"><i>106</i>&nbsp;    public static final ParseField AGGREGATIONS_FIELD = new ParseField(&quot;aggregations&quot;);</b>
<b class="fc"><i>107</i>&nbsp;    public static final ParseField AGGS_FIELD = new ParseField(&quot;aggs&quot;);</b>
<b class="fc"><i>108</i>&nbsp;    public static final ParseField HIGHLIGHT_FIELD = new ParseField(&quot;highlight&quot;);</b>
<b class="fc"><i>109</i>&nbsp;    public static final ParseField SUGGEST_FIELD = new ParseField(&quot;suggest&quot;);</b>
<b class="fc"><i>110</i>&nbsp;    public static final ParseField RESCORE_FIELD = new ParseField(&quot;rescore&quot;);</b>
<b class="fc"><i>111</i>&nbsp;    public static final ParseField STATS_FIELD = new ParseField(&quot;stats&quot;);</b>
<b class="fc"><i>112</i>&nbsp;    public static final ParseField EXT_FIELD = new ParseField(&quot;ext&quot;);</b>
<b class="fc"><i>113</i>&nbsp;    public static final ParseField PROFILE_FIELD = new ParseField(&quot;profile&quot;);</b>
<b class="fc"><i>114</i>&nbsp;    public static final ParseField SEARCH_AFTER = new ParseField(&quot;search_after&quot;);</b>
<b class="fc"><i>115</i>&nbsp;    public static final ParseField COLLAPSE = new ParseField(&quot;collapse&quot;);</b>
<b class="fc"><i>116</i>&nbsp;    public static final ParseField SLICE = new ParseField(&quot;slice&quot;);</b>
<i>117</i>&nbsp;
<i>118</i>&nbsp;    public static SearchSourceBuilder fromXContent(XContentParser parser) throws IOException {
<b class="nc"><i>119</i>&nbsp;        return fromXContent(parser, true);</b>
<i>120</i>&nbsp;    }
<i>121</i>&nbsp;
<i>122</i>&nbsp;    public static SearchSourceBuilder fromXContent(XContentParser parser, boolean checkTrailingTokens) throws IOException {
<b class="nc"><i>123</i>&nbsp;        SearchSourceBuilder builder = new SearchSourceBuilder();</b>
<b class="nc"><i>124</i>&nbsp;        builder.parseXContent(parser, checkTrailingTokens);</b>
<b class="nc"><i>125</i>&nbsp;        return builder;</b>
<i>126</i>&nbsp;    }
<i>127</i>&nbsp;
<i>128</i>&nbsp;    /**
<i>129</i>&nbsp;     * A static factory method to construct a new search source.
<i>130</i>&nbsp;     */
<i>131</i>&nbsp;    public static SearchSourceBuilder searchSource() {
<b class="nc"><i>132</i>&nbsp;        return new SearchSourceBuilder();</b>
<i>133</i>&nbsp;    }
<i>134</i>&nbsp;
<i>135</i>&nbsp;    /**
<i>136</i>&nbsp;     * A static factory method to construct new search highlights.
<i>137</i>&nbsp;     */
<i>138</i>&nbsp;    public static HighlightBuilder highlight() {
<b class="nc"><i>139</i>&nbsp;        return new HighlightBuilder();</b>
<i>140</i>&nbsp;    }
<i>141</i>&nbsp;
<i>142</i>&nbsp;    private QueryBuilder queryBuilder;
<i>143</i>&nbsp;
<i>144</i>&nbsp;    private QueryBuilder postQueryBuilder;
<i>145</i>&nbsp;
<b class="nc"><i>146</i>&nbsp;    private int from = -1;</b>
<i>147</i>&nbsp;
<b class="nc"><i>148</i>&nbsp;    private int size = -1;</b>
<i>149</i>&nbsp;
<i>150</i>&nbsp;    private Boolean explain;
<i>151</i>&nbsp;
<i>152</i>&nbsp;    private Boolean version;
<i>153</i>&nbsp;
<i>154</i>&nbsp;    private Boolean seqNoAndPrimaryTerm;
<i>155</i>&nbsp;
<i>156</i>&nbsp;    private List&lt;SortBuilder&lt;?&gt;&gt; sorts;
<i>157</i>&nbsp;
<b class="nc"><i>158</i>&nbsp;    private boolean trackScores = false;</b>
<i>159</i>&nbsp;
<i>160</i>&nbsp;    private Integer trackTotalHitsUpTo;
<i>161</i>&nbsp;
<i>162</i>&nbsp;    private SearchAfterBuilder searchAfterBuilder;
<i>163</i>&nbsp;
<i>164</i>&nbsp;    private SliceBuilder sliceBuilder;
<i>165</i>&nbsp;
<i>166</i>&nbsp;    private Float minScore;
<i>167</i>&nbsp;
<b class="nc"><i>168</i>&nbsp;    private TimeValue timeout = null;</b>
<b class="nc"><i>169</i>&nbsp;    private int terminateAfter = SearchContext.DEFAULT_TERMINATE_AFTER;</b>
<i>170</i>&nbsp;
<i>171</i>&nbsp;    private StoredFieldsContext storedFieldsContext;
<i>172</i>&nbsp;    private List&lt;FieldAndFormat&gt; docValueFields;
<i>173</i>&nbsp;    private List&lt;ScriptField&gt; scriptFields;
<i>174</i>&nbsp;    private FetchSourceContext fetchSourceContext;
<i>175</i>&nbsp;
<i>176</i>&nbsp;    private AggregatorFactories.Builder aggregations;
<i>177</i>&nbsp;
<i>178</i>&nbsp;    private HighlightBuilder highlightBuilder;
<i>179</i>&nbsp;
<i>180</i>&nbsp;    private SuggestBuilder suggestBuilder;
<i>181</i>&nbsp;
<i>182</i>&nbsp;    private List&lt;RescorerBuilder&gt; rescoreBuilders;
<i>183</i>&nbsp;
<b class="nc"><i>184</i>&nbsp;    private List&lt;IndexBoost&gt; indexBoosts = new ArrayList&lt;&gt;();</b>
<i>185</i>&nbsp;
<i>186</i>&nbsp;    private List&lt;String&gt; stats;
<i>187</i>&nbsp;
<b class="nc"><i>188</i>&nbsp;    private List&lt;SearchExtBuilder&gt; extBuilders = Collections.emptyList();</b>
<i>189</i>&nbsp;
<b class="nc"><i>190</i>&nbsp;    private boolean profile = false;</b>
<i>191</i>&nbsp;
<b class="nc"><i>192</i>&nbsp;    private CollapseBuilder collapse = null;</b>
<i>193</i>&nbsp;
<i>194</i>&nbsp;    /**
<i>195</i>&nbsp;     * Constructs a new search source builder.
<i>196</i>&nbsp;     */
<b class="nc"><i>197</i>&nbsp;    public SearchSourceBuilder() {</b>
<b class="nc"><i>198</i>&nbsp;    }</b>
<i>199</i>&nbsp;
<i>200</i>&nbsp;    /**
<i>201</i>&nbsp;     * Read from a stream.
<i>202</i>&nbsp;     */
<b class="nc"><i>203</i>&nbsp;    public SearchSourceBuilder(StreamInput in) throws IOException {</b>
<b class="nc"><i>204</i>&nbsp;        aggregations = in.readOptionalWriteable(AggregatorFactories.Builder::new);</b>
<b class="nc"><i>205</i>&nbsp;        explain = in.readOptionalBoolean();</b>
<b class="nc"><i>206</i>&nbsp;        fetchSourceContext = in.readOptionalWriteable(FetchSourceContext::new);</b>
<b class="nc"><i>207</i>&nbsp;        if (in.getVersion().before(Version.V_6_4_0)) {</b>
<b class="nc"><i>208</i>&nbsp;            List&lt;String&gt; dvFields = (List&lt;String&gt;) in.readGenericValue();</b>
<b class="nc"><i>209</i>&nbsp;            if (dvFields == null) {</b>
<b class="nc"><i>210</i>&nbsp;                docValueFields = null;</b>
<i>211</i>&nbsp;            } else {
<b class="nc"><i>212</i>&nbsp;                docValueFields = dvFields.stream()</b>
<b class="nc"><i>213</i>&nbsp;                        .map(field -&gt; new FieldAndFormat(field, null))</b>
<b class="nc"><i>214</i>&nbsp;                        .collect(Collectors.toList());</b>
<i>215</i>&nbsp;            }
<b class="nc"><i>216</i>&nbsp;        } else {</b>
<b class="nc"><i>217</i>&nbsp;            if (in.readBoolean()) {</b>
<b class="nc"><i>218</i>&nbsp;                docValueFields = in.readList(FieldAndFormat::new);</b>
<i>219</i>&nbsp;            } else {
<b class="nc"><i>220</i>&nbsp;                docValueFields = null;</b>
<i>221</i>&nbsp;            }
<i>222</i>&nbsp;        }
<b class="nc"><i>223</i>&nbsp;        storedFieldsContext = in.readOptionalWriteable(StoredFieldsContext::new);</b>
<b class="nc"><i>224</i>&nbsp;        from = in.readVInt();</b>
<b class="nc"><i>225</i>&nbsp;        highlightBuilder = in.readOptionalWriteable(HighlightBuilder::new);</b>
<b class="nc"><i>226</i>&nbsp;        indexBoosts = in.readList(IndexBoost::new);</b>
<b class="nc"><i>227</i>&nbsp;        minScore = in.readOptionalFloat();</b>
<b class="nc"><i>228</i>&nbsp;        postQueryBuilder = in.readOptionalNamedWriteable(QueryBuilder.class);</b>
<b class="nc"><i>229</i>&nbsp;        queryBuilder = in.readOptionalNamedWriteable(QueryBuilder.class);</b>
<b class="nc"><i>230</i>&nbsp;        if (in.readBoolean()) {</b>
<b class="nc"><i>231</i>&nbsp;            rescoreBuilders = in.readNamedWriteableList(RescorerBuilder.class);</b>
<i>232</i>&nbsp;        }
<b class="nc"><i>233</i>&nbsp;        if (in.readBoolean()) {</b>
<b class="nc"><i>234</i>&nbsp;            scriptFields = in.readList(ScriptField::new);</b>
<i>235</i>&nbsp;        }
<b class="nc"><i>236</i>&nbsp;        size = in.readVInt();</b>
<b class="nc"><i>237</i>&nbsp;        if (in.readBoolean()) {</b>
<b class="nc"><i>238</i>&nbsp;            int size = in.readVInt();</b>
<b class="nc"><i>239</i>&nbsp;            sorts = new ArrayList&lt;&gt;();</b>
<b class="nc"><i>240</i>&nbsp;            for (int i = 0; i &lt; size; i++) {</b>
<b class="nc"><i>241</i>&nbsp;                sorts.add(in.readNamedWriteable(SortBuilder.class));</b>
<i>242</i>&nbsp;            }
<i>243</i>&nbsp;        }
<b class="nc"><i>244</i>&nbsp;        if (in.readBoolean()) {</b>
<b class="nc"><i>245</i>&nbsp;            stats = in.readStringList();</b>
<i>246</i>&nbsp;        }
<b class="nc"><i>247</i>&nbsp;        suggestBuilder = in.readOptionalWriteable(SuggestBuilder::new);</b>
<b class="nc"><i>248</i>&nbsp;        terminateAfter = in.readVInt();</b>
<b class="nc"><i>249</i>&nbsp;        timeout = in.readOptionalTimeValue();</b>
<b class="nc"><i>250</i>&nbsp;        trackScores = in.readBoolean();</b>
<b class="nc"><i>251</i>&nbsp;        version = in.readOptionalBoolean();</b>
<b class="nc"><i>252</i>&nbsp;        if (in.getVersion().onOrAfter(Version.V_6_7_0)) {</b>
<b class="nc"><i>253</i>&nbsp;            seqNoAndPrimaryTerm = in.readOptionalBoolean();</b>
<i>254</i>&nbsp;        } else {
<b class="nc"><i>255</i>&nbsp;            seqNoAndPrimaryTerm = null;</b>
<i>256</i>&nbsp;        }
<b class="nc"><i>257</i>&nbsp;        extBuilders = in.readNamedWriteableList(SearchExtBuilder.class);</b>
<b class="nc"><i>258</i>&nbsp;        profile = in.readBoolean();</b>
<b class="nc"><i>259</i>&nbsp;        searchAfterBuilder = in.readOptionalWriteable(SearchAfterBuilder::new);</b>
<b class="nc"><i>260</i>&nbsp;        sliceBuilder = in.readOptionalWriteable(SliceBuilder::new);</b>
<b class="nc"><i>261</i>&nbsp;        collapse = in.readOptionalWriteable(CollapseBuilder::new);</b>
<b class="nc"><i>262</i>&nbsp;        if (in.getVersion().onOrAfter(Version.V_7_0_0)) {</b>
<b class="nc"><i>263</i>&nbsp;            trackTotalHitsUpTo = in.readOptionalInt();</b>
<i>264</i>&nbsp;        } else {
<b class="nc"><i>265</i>&nbsp;            trackTotalHitsUpTo = in.readBoolean() ? TRACK_TOTAL_HITS_ACCURATE : TRACK_TOTAL_HITS_DISABLED;</b>
<i>266</i>&nbsp;        }
<b class="nc"><i>267</i>&nbsp;    }</b>
<i>268</i>&nbsp;
<i>269</i>&nbsp;    @Override
<i>270</i>&nbsp;    public void writeTo(StreamOutput out) throws IOException {
<b class="nc"><i>271</i>&nbsp;        out.writeOptionalWriteable(aggregations);</b>
<b class="nc"><i>272</i>&nbsp;        out.writeOptionalBoolean(explain);</b>
<b class="nc"><i>273</i>&nbsp;        out.writeOptionalWriteable(fetchSourceContext);</b>
<b class="nc"><i>274</i>&nbsp;        if (out.getVersion().before(Version.V_6_4_0)) {</b>
<b class="nc"><i>275</i>&nbsp;            out.writeGenericValue(docValueFields == null</b>
<b class="nc"><i>276</i>&nbsp;                    ? null</b>
<b class="nc"><i>277</i>&nbsp;                    : docValueFields.stream().map(ff -&gt; ff.field).collect(Collectors.toList()));</b>
<i>278</i>&nbsp;        } else {
<b class="nc"><i>279</i>&nbsp;            out.writeBoolean(docValueFields != null);</b>
<b class="nc"><i>280</i>&nbsp;            if (docValueFields != null) {</b>
<b class="nc"><i>281</i>&nbsp;                out.writeList(docValueFields);</b>
<i>282</i>&nbsp;            }
<i>283</i>&nbsp;        }
<b class="nc"><i>284</i>&nbsp;        out.writeOptionalWriteable(storedFieldsContext);</b>
<b class="nc"><i>285</i>&nbsp;        out.writeVInt(from);</b>
<b class="nc"><i>286</i>&nbsp;        out.writeOptionalWriteable(highlightBuilder);</b>
<b class="nc"><i>287</i>&nbsp;        out.writeList(indexBoosts);</b>
<b class="nc"><i>288</i>&nbsp;        out.writeOptionalFloat(minScore);</b>
<b class="nc"><i>289</i>&nbsp;        out.writeOptionalNamedWriteable(postQueryBuilder);</b>
<b class="nc"><i>290</i>&nbsp;        out.writeOptionalNamedWriteable(queryBuilder);</b>
<b class="nc"><i>291</i>&nbsp;        boolean hasRescoreBuilders = rescoreBuilders != null;</b>
<b class="nc"><i>292</i>&nbsp;        out.writeBoolean(hasRescoreBuilders);</b>
<b class="nc"><i>293</i>&nbsp;        if (hasRescoreBuilders) {</b>
<b class="nc"><i>294</i>&nbsp;            out.writeNamedWriteableList(rescoreBuilders);</b>
<i>295</i>&nbsp;        }
<b class="nc"><i>296</i>&nbsp;        boolean hasScriptFields = scriptFields != null;</b>
<b class="nc"><i>297</i>&nbsp;        out.writeBoolean(hasScriptFields);</b>
<b class="nc"><i>298</i>&nbsp;        if (hasScriptFields) {</b>
<b class="nc"><i>299</i>&nbsp;            out.writeList(scriptFields);</b>
<i>300</i>&nbsp;        }
<b class="nc"><i>301</i>&nbsp;        out.writeVInt(size);</b>
<b class="nc"><i>302</i>&nbsp;        boolean hasSorts = sorts != null;</b>
<b class="nc"><i>303</i>&nbsp;        out.writeBoolean(hasSorts);</b>
<b class="nc"><i>304</i>&nbsp;        if (hasSorts) {</b>
<b class="nc"><i>305</i>&nbsp;            out.writeVInt(sorts.size());</b>
<b class="nc"><i>306</i>&nbsp;            for (SortBuilder&lt;?&gt; sort : sorts) {</b>
<b class="nc"><i>307</i>&nbsp;                out.writeNamedWriteable(sort);</b>
<b class="nc"><i>308</i>&nbsp;            }</b>
<i>309</i>&nbsp;        }
<b class="nc"><i>310</i>&nbsp;        boolean hasStats = stats != null;</b>
<b class="nc"><i>311</i>&nbsp;        out.writeBoolean(hasStats);</b>
<b class="nc"><i>312</i>&nbsp;        if (hasStats) {</b>
<b class="nc"><i>313</i>&nbsp;            out.writeStringCollection(stats);</b>
<i>314</i>&nbsp;        }
<b class="nc"><i>315</i>&nbsp;        out.writeOptionalWriteable(suggestBuilder);</b>
<b class="nc"><i>316</i>&nbsp;        out.writeVInt(terminateAfter);</b>
<b class="nc"><i>317</i>&nbsp;        out.writeOptionalTimeValue(timeout);</b>
<b class="nc"><i>318</i>&nbsp;        out.writeBoolean(trackScores);</b>
<b class="nc"><i>319</i>&nbsp;        out.writeOptionalBoolean(version);</b>
<b class="nc"><i>320</i>&nbsp;        if (out.getVersion().onOrAfter(Version.V_6_7_0)) {</b>
<b class="nc"><i>321</i>&nbsp;            out.writeOptionalBoolean(seqNoAndPrimaryTerm);</b>
<i>322</i>&nbsp;        }
<b class="nc"><i>323</i>&nbsp;        out.writeNamedWriteableList(extBuilders);</b>
<b class="nc"><i>324</i>&nbsp;        out.writeBoolean(profile);</b>
<b class="nc"><i>325</i>&nbsp;        out.writeOptionalWriteable(searchAfterBuilder);</b>
<b class="nc"><i>326</i>&nbsp;        out.writeOptionalWriteable(sliceBuilder);</b>
<b class="nc"><i>327</i>&nbsp;        out.writeOptionalWriteable(collapse);</b>
<b class="nc"><i>328</i>&nbsp;        if (out.getVersion().onOrAfter(Version.V_7_0_0)) {</b>
<b class="nc"><i>329</i>&nbsp;            out.writeOptionalInt(trackTotalHitsUpTo);</b>
<i>330</i>&nbsp;        } else {
<b class="nc"><i>331</i>&nbsp;            out.writeBoolean(trackTotalHitsUpTo == null ? true : trackTotalHitsUpTo &gt; SearchContext.TRACK_TOTAL_HITS_DISABLED);</b>
<i>332</i>&nbsp;        }
<b class="nc"><i>333</i>&nbsp;    }</b>
<i>334</i>&nbsp;
<i>335</i>&nbsp;    /**
<i>336</i>&nbsp;     * Sets the search query for this request.
<i>337</i>&nbsp;     *
<i>338</i>&nbsp;     * @see org.elasticsearch.index.query.QueryBuilders
<i>339</i>&nbsp;     */
<i>340</i>&nbsp;    public SearchSourceBuilder query(QueryBuilder query) {
<b class="nc"><i>341</i>&nbsp;        this.queryBuilder = query;</b>
<b class="nc"><i>342</i>&nbsp;        return this;</b>
<i>343</i>&nbsp;    }
<i>344</i>&nbsp;
<i>345</i>&nbsp;    /**
<i>346</i>&nbsp;     * Gets the query for this request
<i>347</i>&nbsp;     */
<i>348</i>&nbsp;    public QueryBuilder query() {
<b class="nc"><i>349</i>&nbsp;        return queryBuilder;</b>
<i>350</i>&nbsp;    }
<i>351</i>&nbsp;
<i>352</i>&nbsp;    /**
<i>353</i>&nbsp;     * Sets a filter that will be executed after the query has been executed and
<i>354</i>&nbsp;     * only has affect on the search hits (not aggregations). This filter is
<i>355</i>&nbsp;     * always executed as last filtering mechanism.
<i>356</i>&nbsp;     */
<i>357</i>&nbsp;    public SearchSourceBuilder postFilter(QueryBuilder postFilter) {
<b class="nc"><i>358</i>&nbsp;        this.postQueryBuilder = postFilter;</b>
<b class="nc"><i>359</i>&nbsp;        return this;</b>
<i>360</i>&nbsp;    }
<i>361</i>&nbsp;
<i>362</i>&nbsp;    /**
<i>363</i>&nbsp;     * Gets the post filter for this request
<i>364</i>&nbsp;     */
<i>365</i>&nbsp;    public QueryBuilder postFilter() {
<b class="nc"><i>366</i>&nbsp;        return postQueryBuilder;</b>
<i>367</i>&nbsp;    }
<i>368</i>&nbsp;
<i>369</i>&nbsp;    /**
<i>370</i>&nbsp;     * From index to start the search from. Defaults to {@code 0}.
<i>371</i>&nbsp;     */
<i>372</i>&nbsp;    public SearchSourceBuilder from(int from) {
<b class="nc"><i>373</i>&nbsp;        if (from &lt; 0) {</b>
<b class="nc"><i>374</i>&nbsp;            throw new IllegalArgumentException(&quot;[from] parameter cannot be negative&quot;);</b>
<i>375</i>&nbsp;        }
<b class="nc"><i>376</i>&nbsp;        this.from = from;</b>
<b class="nc"><i>377</i>&nbsp;        return this;</b>
<i>378</i>&nbsp;    }
<i>379</i>&nbsp;
<i>380</i>&nbsp;    /**
<i>381</i>&nbsp;     * Gets the from index to start the search from.
<i>382</i>&nbsp;     **/
<i>383</i>&nbsp;    public int from() {
<b class="nc"><i>384</i>&nbsp;        return from;</b>
<i>385</i>&nbsp;    }
<i>386</i>&nbsp;
<i>387</i>&nbsp;    /**
<i>388</i>&nbsp;     * The number of search hits to return. Defaults to {@code 10}.
<i>389</i>&nbsp;     */
<i>390</i>&nbsp;    public SearchSourceBuilder size(int size) {
<b class="nc"><i>391</i>&nbsp;        if (size &lt; 0) {</b>
<b class="nc"><i>392</i>&nbsp;            throw new IllegalArgumentException(&quot;[size] parameter cannot be negative, found [&quot; + size + &quot;]&quot;);</b>
<i>393</i>&nbsp;        }
<b class="nc"><i>394</i>&nbsp;        this.size = size;</b>
<b class="nc"><i>395</i>&nbsp;        return this;</b>
<i>396</i>&nbsp;    }
<i>397</i>&nbsp;
<i>398</i>&nbsp;    /**
<i>399</i>&nbsp;     * Gets the number of search hits to return.
<i>400</i>&nbsp;     */
<i>401</i>&nbsp;    public int size() {
<b class="nc"><i>402</i>&nbsp;        return size;</b>
<i>403</i>&nbsp;    }
<i>404</i>&nbsp;
<i>405</i>&nbsp;    /**
<i>406</i>&nbsp;     * Sets the minimum score below which docs will be filtered out.
<i>407</i>&nbsp;     */
<i>408</i>&nbsp;    public SearchSourceBuilder minScore(float minScore) {
<b class="nc"><i>409</i>&nbsp;        this.minScore = minScore;</b>
<b class="nc"><i>410</i>&nbsp;        return this;</b>
<i>411</i>&nbsp;    }
<i>412</i>&nbsp;
<i>413</i>&nbsp;    /**
<i>414</i>&nbsp;     * Gets the minimum score below which docs will be filtered out.
<i>415</i>&nbsp;     */
<i>416</i>&nbsp;    public Float minScore() {
<b class="nc"><i>417</i>&nbsp;        return minScore;</b>
<i>418</i>&nbsp;    }
<i>419</i>&nbsp;
<i>420</i>&nbsp;    /**
<i>421</i>&nbsp;     * Should each {@link org.elasticsearch.search.SearchHit} be returned with
<i>422</i>&nbsp;     * an explanation of the hit (ranking).
<i>423</i>&nbsp;     */
<i>424</i>&nbsp;    public SearchSourceBuilder explain(Boolean explain) {
<b class="nc"><i>425</i>&nbsp;        this.explain = explain;</b>
<b class="nc"><i>426</i>&nbsp;        return this;</b>
<i>427</i>&nbsp;    }
<i>428</i>&nbsp;
<i>429</i>&nbsp;    /**
<i>430</i>&nbsp;     * Indicates whether each search hit will be returned with an explanation of
<i>431</i>&nbsp;     * the hit (ranking)
<i>432</i>&nbsp;     */
<i>433</i>&nbsp;    public Boolean explain() {
<b class="nc"><i>434</i>&nbsp;        return explain;</b>
<i>435</i>&nbsp;    }
<i>436</i>&nbsp;
<i>437</i>&nbsp;    /**
<i>438</i>&nbsp;     * Should each {@link org.elasticsearch.search.SearchHit} be returned with a
<i>439</i>&nbsp;     * version associated with it.
<i>440</i>&nbsp;     */
<i>441</i>&nbsp;    public SearchSourceBuilder version(Boolean version) {
<b class="nc"><i>442</i>&nbsp;        this.version = version;</b>
<b class="nc"><i>443</i>&nbsp;        return this;</b>
<i>444</i>&nbsp;    }
<i>445</i>&nbsp;
<i>446</i>&nbsp;    /**
<i>447</i>&nbsp;     * Indicates whether the document&#39;s version will be included in the search
<i>448</i>&nbsp;     * hits.
<i>449</i>&nbsp;     */
<i>450</i>&nbsp;    public Boolean version() {
<b class="nc"><i>451</i>&nbsp;        return version;</b>
<i>452</i>&nbsp;    }
<i>453</i>&nbsp;
<i>454</i>&nbsp;    /**
<i>455</i>&nbsp;     * Should each {@link org.elasticsearch.search.SearchHit} be returned with the
<i>456</i>&nbsp;     * sequence number and primary term of the last modification of the document.
<i>457</i>&nbsp;     */
<i>458</i>&nbsp;    public SearchSourceBuilder seqNoAndPrimaryTerm(Boolean seqNoAndPrimaryTerm) {
<b class="nc"><i>459</i>&nbsp;        this.seqNoAndPrimaryTerm = seqNoAndPrimaryTerm;</b>
<b class="nc"><i>460</i>&nbsp;        return this;</b>
<i>461</i>&nbsp;    }
<i>462</i>&nbsp;
<i>463</i>&nbsp;    /**
<i>464</i>&nbsp;     * Indicates whether {@link org.elasticsearch.search.SearchHit}s should be returned with the
<i>465</i>&nbsp;     * sequence number and primary term of the last modification of the document.
<i>466</i>&nbsp;     */
<i>467</i>&nbsp;    public Boolean seqNoAndPrimaryTerm() {
<b class="nc"><i>468</i>&nbsp;        return seqNoAndPrimaryTerm;</b>
<i>469</i>&nbsp;    }
<i>470</i>&nbsp;
<i>471</i>&nbsp;    /**
<i>472</i>&nbsp;     * An optional timeout to control how long search is allowed to take.
<i>473</i>&nbsp;     */
<i>474</i>&nbsp;    public SearchSourceBuilder timeout(TimeValue timeout) {
<b class="nc"><i>475</i>&nbsp;        this.timeout = timeout;</b>
<b class="nc"><i>476</i>&nbsp;        return this;</b>
<i>477</i>&nbsp;    }
<i>478</i>&nbsp;
<i>479</i>&nbsp;    /**
<i>480</i>&nbsp;     * Gets the timeout to control how long search is allowed to take.
<i>481</i>&nbsp;     */
<i>482</i>&nbsp;    public TimeValue timeout() {
<b class="nc"><i>483</i>&nbsp;        return timeout;</b>
<i>484</i>&nbsp;    }
<i>485</i>&nbsp;
<i>486</i>&nbsp;    /**
<i>487</i>&nbsp;     * An optional terminate_after to terminate the search after collecting
<i>488</i>&nbsp;     * &lt;code&gt;terminateAfter&lt;/code&gt; documents
<i>489</i>&nbsp;     */
<i>490</i>&nbsp;    public  SearchSourceBuilder terminateAfter(int terminateAfter) {
<b class="nc"><i>491</i>&nbsp;        if (terminateAfter &lt; 0) {</b>
<b class="nc"><i>492</i>&nbsp;            throw new IllegalArgumentException(&quot;terminateAfter must be &gt; 0&quot;);</b>
<i>493</i>&nbsp;        }
<b class="nc"><i>494</i>&nbsp;        this.terminateAfter = terminateAfter;</b>
<b class="nc"><i>495</i>&nbsp;        return this;</b>
<i>496</i>&nbsp;    }
<i>497</i>&nbsp;
<i>498</i>&nbsp;    /**
<i>499</i>&nbsp;     * Gets the number of documents to terminate after collecting.
<i>500</i>&nbsp;     */
<i>501</i>&nbsp;    public int terminateAfter() {
<b class="nc"><i>502</i>&nbsp;        return terminateAfter;</b>
<i>503</i>&nbsp;    }
<i>504</i>&nbsp;
<i>505</i>&nbsp;    /**
<i>506</i>&nbsp;     * Adds a sort against the given field name and the sort ordering.
<i>507</i>&nbsp;     *
<i>508</i>&nbsp;     * @param name
<i>509</i>&nbsp;     *            The name of the field
<i>510</i>&nbsp;     * @param order
<i>511</i>&nbsp;     *            The sort ordering
<i>512</i>&nbsp;     */
<i>513</i>&nbsp;    public SearchSourceBuilder sort(String name, SortOrder order) {
<b class="nc"><i>514</i>&nbsp;        if (name.equals(ScoreSortBuilder.NAME)) {</b>
<b class="nc"><i>515</i>&nbsp;            return sort(SortBuilders.scoreSort().order(order));</b>
<i>516</i>&nbsp;        }
<b class="nc"><i>517</i>&nbsp;        return sort(SortBuilders.fieldSort(name).order(order));</b>
<i>518</i>&nbsp;    }
<i>519</i>&nbsp;
<i>520</i>&nbsp;    /**
<i>521</i>&nbsp;     * Add a sort against the given field name.
<i>522</i>&nbsp;     *
<i>523</i>&nbsp;     * @param name
<i>524</i>&nbsp;     *            The name of the field to sort by
<i>525</i>&nbsp;     */
<i>526</i>&nbsp;    public SearchSourceBuilder sort(String name) {
<b class="nc"><i>527</i>&nbsp;        if (name.equals(ScoreSortBuilder.NAME)) {</b>
<b class="nc"><i>528</i>&nbsp;            return sort(SortBuilders.scoreSort());</b>
<i>529</i>&nbsp;        }
<b class="nc"><i>530</i>&nbsp;        return sort(SortBuilders.fieldSort(name));</b>
<i>531</i>&nbsp;    }
<i>532</i>&nbsp;
<i>533</i>&nbsp;    /**
<i>534</i>&nbsp;     * Adds a sort builder.
<i>535</i>&nbsp;     */
<i>536</i>&nbsp;    public SearchSourceBuilder sort(SortBuilder&lt;?&gt; sort) {
<b class="nc"><i>537</i>&nbsp;            if (sorts == null) {</b>
<b class="nc"><i>538</i>&nbsp;                sorts = new ArrayList&lt;&gt;();</b>
<i>539</i>&nbsp;            }
<b class="nc"><i>540</i>&nbsp;            sorts.add(sort);</b>
<b class="nc"><i>541</i>&nbsp;            return this;</b>
<i>542</i>&nbsp;    }
<i>543</i>&nbsp;
<i>544</i>&nbsp;    /**
<i>545</i>&nbsp;     * Gets the bytes representing the sort builders for this request.
<i>546</i>&nbsp;     */
<i>547</i>&nbsp;    public List&lt;SortBuilder&lt;?&gt;&gt; sorts() {
<b class="nc"><i>548</i>&nbsp;        return sorts;</b>
<i>549</i>&nbsp;    }
<i>550</i>&nbsp;
<i>551</i>&nbsp;    /**
<i>552</i>&nbsp;     * Applies when sorting, and controls if scores will be tracked as well.
<i>553</i>&nbsp;     * Defaults to {@code false}.
<i>554</i>&nbsp;     */
<i>555</i>&nbsp;    public SearchSourceBuilder trackScores(boolean trackScores) {
<b class="nc"><i>556</i>&nbsp;        this.trackScores = trackScores;</b>
<b class="nc"><i>557</i>&nbsp;        return this;</b>
<i>558</i>&nbsp;    }
<i>559</i>&nbsp;
<i>560</i>&nbsp;    /**
<i>561</i>&nbsp;     * Indicates whether scores will be tracked for this request.
<i>562</i>&nbsp;     */
<i>563</i>&nbsp;    public boolean trackScores() {
<b class="nc"><i>564</i>&nbsp;        return trackScores;</b>
<i>565</i>&nbsp;    }
<i>566</i>&nbsp;
<i>567</i>&nbsp;    /**
<i>568</i>&nbsp;     * Indicates if the total hit count for the query should be tracked.
<i>569</i>&nbsp;     */
<i>570</i>&nbsp;    public SearchSourceBuilder trackTotalHits(boolean trackTotalHits) {
<b class="nc"><i>571</i>&nbsp;        this.trackTotalHitsUpTo = trackTotalHits ? TRACK_TOTAL_HITS_ACCURATE : TRACK_TOTAL_HITS_DISABLED;</b>
<b class="nc"><i>572</i>&nbsp;        return this;</b>
<i>573</i>&nbsp;    }
<i>574</i>&nbsp;
<i>575</i>&nbsp;    /**
<i>576</i>&nbsp;     * Returns the total hit count that should be tracked or null if the value is unset.
<i>577</i>&nbsp;     * Defaults to null.
<i>578</i>&nbsp;     */
<i>579</i>&nbsp;    @Nullable
<i>580</i>&nbsp;    public Integer trackTotalHitsUpTo() {
<b class="nc"><i>581</i>&nbsp;        return trackTotalHitsUpTo;</b>
<i>582</i>&nbsp;    }
<i>583</i>&nbsp;
<i>584</i>&nbsp;    public SearchSourceBuilder trackTotalHitsUpTo(int trackTotalHitsUpTo) {
<b class="nc"><i>585</i>&nbsp;        if (trackTotalHitsUpTo &lt; TRACK_TOTAL_HITS_DISABLED) {</b>
<b class="nc"><i>586</i>&nbsp;            throw new IllegalArgumentException(&quot;[track_total_hits] parameter must be positive or equals to -1, &quot; +</b>
<i>587</i>&nbsp;                &quot;got &quot; + trackTotalHitsUpTo);
<i>588</i>&nbsp;        }
<b class="nc"><i>589</i>&nbsp;        this.trackTotalHitsUpTo = trackTotalHitsUpTo;</b>
<b class="nc"><i>590</i>&nbsp;        return this;</b>
<i>591</i>&nbsp;    }
<i>592</i>&nbsp;
<i>593</i>&nbsp;    /**
<i>594</i>&nbsp;     * The sort values that indicates which docs this request should &quot;search after&quot;.
<i>595</i>&nbsp;     * The sort values of the search_after must be equal to the number of sort fields in the query and they should be
<i>596</i>&nbsp;     * of the same type (or parsable as such).
<i>597</i>&nbsp;     * Defaults to {@code null}.
<i>598</i>&nbsp;     */
<i>599</i>&nbsp;    public Object[] searchAfter() {
<b class="nc"><i>600</i>&nbsp;        if (searchAfterBuilder == null) {</b>
<b class="nc"><i>601</i>&nbsp;            return null;</b>
<i>602</i>&nbsp;        }
<b class="nc"><i>603</i>&nbsp;        return searchAfterBuilder.getSortValues();</b>
<i>604</i>&nbsp;    }
<i>605</i>&nbsp;
<i>606</i>&nbsp;    /**
<i>607</i>&nbsp;     * Set the sort values that indicates which docs this request should &quot;search after&quot;.
<i>608</i>&nbsp;     */
<i>609</i>&nbsp;    public SearchSourceBuilder searchAfter(Object[] values) {
<b class="nc"><i>610</i>&nbsp;        this.searchAfterBuilder = new SearchAfterBuilder().setSortValues(values);</b>
<b class="nc"><i>611</i>&nbsp;        return this;</b>
<i>612</i>&nbsp;    }
<i>613</i>&nbsp;
<i>614</i>&nbsp;    /**
<i>615</i>&nbsp;     * Sets a filter that will restrict the search hits, the top hits and the aggregations to a slice of the results
<i>616</i>&nbsp;     * of the main query.
<i>617</i>&nbsp;     */
<i>618</i>&nbsp;    public SearchSourceBuilder slice(SliceBuilder builder) {
<b class="nc"><i>619</i>&nbsp;        this.sliceBuilder = builder;</b>
<b class="nc"><i>620</i>&nbsp;        return this;</b>
<i>621</i>&nbsp;    }
<i>622</i>&nbsp;
<i>623</i>&nbsp;    /**
<i>624</i>&nbsp;     * Gets the slice used to filter the search hits, the top hits and the aggregations.
<i>625</i>&nbsp;     */
<i>626</i>&nbsp;    public SliceBuilder slice() {
<b class="nc"><i>627</i>&nbsp;        return sliceBuilder;</b>
<i>628</i>&nbsp;    }
<i>629</i>&nbsp;
<i>630</i>&nbsp;
<i>631</i>&nbsp;    public CollapseBuilder collapse() {
<b class="nc"><i>632</i>&nbsp;        return collapse;</b>
<i>633</i>&nbsp;    }
<i>634</i>&nbsp;
<i>635</i>&nbsp;    public SearchSourceBuilder collapse(CollapseBuilder collapse) {
<b class="nc"><i>636</i>&nbsp;        this.collapse = collapse;</b>
<b class="nc"><i>637</i>&nbsp;        return this;</b>
<i>638</i>&nbsp;    }
<i>639</i>&nbsp;
<i>640</i>&nbsp;    /**
<i>641</i>&nbsp;     * Add an aggregation to perform as part of the search.
<i>642</i>&nbsp;     */
<i>643</i>&nbsp;    public SearchSourceBuilder aggregation(AggregationBuilder aggregation) {
<b class="nc"><i>644</i>&nbsp;        if (aggregations == null) {</b>
<b class="nc"><i>645</i>&nbsp;            aggregations = AggregatorFactories.builder();</b>
<i>646</i>&nbsp;        }
<b class="nc"><i>647</i>&nbsp;        aggregations.addAggregator(aggregation);</b>
<b class="nc"><i>648</i>&nbsp;        return this;</b>
<i>649</i>&nbsp;    }
<i>650</i>&nbsp;
<i>651</i>&nbsp;    /**
<i>652</i>&nbsp;     * Add an aggregation to perform as part of the search.
<i>653</i>&nbsp;     */
<i>654</i>&nbsp;    public SearchSourceBuilder aggregation(PipelineAggregationBuilder aggregation) {
<b class="nc"><i>655</i>&nbsp;        if (aggregations == null) {</b>
<b class="nc"><i>656</i>&nbsp;            aggregations = AggregatorFactories.builder();</b>
<i>657</i>&nbsp;        }
<b class="nc"><i>658</i>&nbsp;        aggregations.addPipelineAggregator(aggregation);</b>
<b class="nc"><i>659</i>&nbsp;        return this;</b>
<i>660</i>&nbsp;    }
<i>661</i>&nbsp;
<i>662</i>&nbsp;    /**
<i>663</i>&nbsp;     * Gets the bytes representing the aggregation builders for this request.
<i>664</i>&nbsp;     */
<i>665</i>&nbsp;    public AggregatorFactories.Builder aggregations() {
<b class="nc"><i>666</i>&nbsp;        return aggregations;</b>
<i>667</i>&nbsp;    }
<i>668</i>&nbsp;
<i>669</i>&nbsp;    /**
<i>670</i>&nbsp;     * Adds highlight to perform as part of the search.
<i>671</i>&nbsp;     */
<i>672</i>&nbsp;    public SearchSourceBuilder highlighter(HighlightBuilder highlightBuilder) {
<b class="nc"><i>673</i>&nbsp;        this.highlightBuilder = highlightBuilder;</b>
<b class="nc"><i>674</i>&nbsp;        return this;</b>
<i>675</i>&nbsp;    }
<i>676</i>&nbsp;
<i>677</i>&nbsp;    /**
<i>678</i>&nbsp;     * Gets the highlighter builder for this request.
<i>679</i>&nbsp;     */
<i>680</i>&nbsp;    public HighlightBuilder highlighter() {
<b class="nc"><i>681</i>&nbsp;        return highlightBuilder;</b>
<i>682</i>&nbsp;    }
<i>683</i>&nbsp;
<i>684</i>&nbsp;    public SearchSourceBuilder suggest(SuggestBuilder suggestBuilder) {
<b class="nc"><i>685</i>&nbsp;        this.suggestBuilder = suggestBuilder;</b>
<b class="nc"><i>686</i>&nbsp;        return this;</b>
<i>687</i>&nbsp;    }
<i>688</i>&nbsp;
<i>689</i>&nbsp;    /**
<i>690</i>&nbsp;     * Gets the suggester builder for this request.
<i>691</i>&nbsp;     */
<i>692</i>&nbsp;    public SuggestBuilder suggest() {
<b class="nc"><i>693</i>&nbsp;        return suggestBuilder;</b>
<i>694</i>&nbsp;    }
<i>695</i>&nbsp;
<i>696</i>&nbsp;    public SearchSourceBuilder addRescorer(RescorerBuilder&lt;?&gt; rescoreBuilder) {
<b class="nc"><i>697</i>&nbsp;            if (rescoreBuilders == null) {</b>
<b class="nc"><i>698</i>&nbsp;                rescoreBuilders = new ArrayList&lt;&gt;();</b>
<i>699</i>&nbsp;            }
<b class="nc"><i>700</i>&nbsp;            rescoreBuilders.add(rescoreBuilder);</b>
<b class="nc"><i>701</i>&nbsp;            return this;</b>
<i>702</i>&nbsp;    }
<i>703</i>&nbsp;
<i>704</i>&nbsp;    public SearchSourceBuilder clearRescorers() {
<b class="nc"><i>705</i>&nbsp;        rescoreBuilders = null;</b>
<b class="nc"><i>706</i>&nbsp;        return this;</b>
<i>707</i>&nbsp;    }
<i>708</i>&nbsp;
<i>709</i>&nbsp;    /**
<i>710</i>&nbsp;     * Should the query be profiled. Defaults to {@code false}
<i>711</i>&nbsp;     */
<i>712</i>&nbsp;    public SearchSourceBuilder profile(boolean profile) {
<b class="nc"><i>713</i>&nbsp;        this.profile = profile;</b>
<b class="nc"><i>714</i>&nbsp;        return this;</b>
<i>715</i>&nbsp;    }
<i>716</i>&nbsp;
<i>717</i>&nbsp;    /**
<i>718</i>&nbsp;     * Return whether to profile query execution, or {@code null} if
<i>719</i>&nbsp;     * unspecified.
<i>720</i>&nbsp;     */
<i>721</i>&nbsp;    public boolean profile() {
<b class="nc"><i>722</i>&nbsp;        return profile;</b>
<i>723</i>&nbsp;    }
<i>724</i>&nbsp;
<i>725</i>&nbsp;    /**
<i>726</i>&nbsp;     * Gets the bytes representing the rescore builders for this request.
<i>727</i>&nbsp;     */
<i>728</i>&nbsp;    public List&lt;RescorerBuilder&gt; rescores() {
<b class="nc"><i>729</i>&nbsp;        return rescoreBuilders;</b>
<i>730</i>&nbsp;    }
<i>731</i>&nbsp;
<i>732</i>&nbsp;    /**
<i>733</i>&nbsp;     * Indicates whether the response should contain the stored _source for
<i>734</i>&nbsp;     * every hit
<i>735</i>&nbsp;     */
<i>736</i>&nbsp;    public SearchSourceBuilder fetchSource(boolean fetch) {
<b class="nc"><i>737</i>&nbsp;        FetchSourceContext fetchSourceContext = this.fetchSourceContext != null ? this.fetchSourceContext</b>
<b class="nc"><i>738</i>&nbsp;            : FetchSourceContext.FETCH_SOURCE;</b>
<b class="nc"><i>739</i>&nbsp;        this.fetchSourceContext = new FetchSourceContext(fetch, fetchSourceContext.includes(), fetchSourceContext.excludes());</b>
<b class="nc"><i>740</i>&nbsp;        return this;</b>
<i>741</i>&nbsp;    }
<i>742</i>&nbsp;
<i>743</i>&nbsp;    /**
<i>744</i>&nbsp;     * Indicate that _source should be returned with every hit, with an
<i>745</i>&nbsp;     * &quot;include&quot; and/or &quot;exclude&quot; set which can include simple wildcard
<i>746</i>&nbsp;     * elements.
<i>747</i>&nbsp;     *
<i>748</i>&nbsp;     * @param include
<i>749</i>&nbsp;     *            An optional include (optionally wildcarded) pattern to filter
<i>750</i>&nbsp;     *            the returned _source
<i>751</i>&nbsp;     * @param exclude
<i>752</i>&nbsp;     *            An optional exclude (optionally wildcarded) pattern to filter
<i>753</i>&nbsp;     *            the returned _source
<i>754</i>&nbsp;     */
<i>755</i>&nbsp;    public SearchSourceBuilder fetchSource(@Nullable String include, @Nullable String exclude) {
<b class="nc"><i>756</i>&nbsp;        return fetchSource(include == null ? Strings.EMPTY_ARRAY : new String[] { include }, exclude == null ? Strings.EMPTY_ARRAY</b>
<b class="nc"><i>757</i>&nbsp;                : new String[] { exclude });</b>
<i>758</i>&nbsp;    }
<i>759</i>&nbsp;
<i>760</i>&nbsp;    /**
<i>761</i>&nbsp;     * Indicate that _source should be returned with every hit, with an
<i>762</i>&nbsp;     * &quot;include&quot; and/or &quot;exclude&quot; set which can include simple wildcard
<i>763</i>&nbsp;     * elements.
<i>764</i>&nbsp;     *
<i>765</i>&nbsp;     * @param includes
<i>766</i>&nbsp;     *            An optional list of include (optionally wildcarded) pattern to
<i>767</i>&nbsp;     *            filter the returned _source
<i>768</i>&nbsp;     * @param excludes
<i>769</i>&nbsp;     *            An optional list of exclude (optionally wildcarded) pattern to
<i>770</i>&nbsp;     *            filter the returned _source
<i>771</i>&nbsp;     */
<i>772</i>&nbsp;    public SearchSourceBuilder fetchSource(@Nullable String[] includes, @Nullable String[] excludes) {
<b class="nc"><i>773</i>&nbsp;        FetchSourceContext fetchSourceContext = this.fetchSourceContext != null ? this.fetchSourceContext</b>
<b class="nc"><i>774</i>&nbsp;            : FetchSourceContext.FETCH_SOURCE;</b>
<b class="nc"><i>775</i>&nbsp;        this.fetchSourceContext = new FetchSourceContext(fetchSourceContext.fetchSource(), includes, excludes);</b>
<b class="nc"><i>776</i>&nbsp;        return this;</b>
<i>777</i>&nbsp;    }
<i>778</i>&nbsp;
<i>779</i>&nbsp;    /**
<i>780</i>&nbsp;     * Indicate how the _source should be fetched.
<i>781</i>&nbsp;     */
<i>782</i>&nbsp;    public SearchSourceBuilder fetchSource(@Nullable FetchSourceContext fetchSourceContext) {
<b class="nc"><i>783</i>&nbsp;        this.fetchSourceContext = fetchSourceContext;</b>
<b class="nc"><i>784</i>&nbsp;        return this;</b>
<i>785</i>&nbsp;    }
<i>786</i>&nbsp;
<i>787</i>&nbsp;    /**
<i>788</i>&nbsp;     * Gets the {@link FetchSourceContext} which defines how the _source should
<i>789</i>&nbsp;     * be fetched.
<i>790</i>&nbsp;     */
<i>791</i>&nbsp;    public FetchSourceContext fetchSource() {
<b class="nc"><i>792</i>&nbsp;        return fetchSourceContext;</b>
<i>793</i>&nbsp;    }
<i>794</i>&nbsp;
<i>795</i>&nbsp;    /**
<i>796</i>&nbsp;     * Adds a stored field to load and return as part of the
<i>797</i>&nbsp;     * search request. If none are specified, the source of the document will be
<i>798</i>&nbsp;     * return.
<i>799</i>&nbsp;     */
<i>800</i>&nbsp;    public SearchSourceBuilder storedField(String name) {
<b class="nc"><i>801</i>&nbsp;        return storedFields(Collections.singletonList(name));</b>
<i>802</i>&nbsp;    }
<i>803</i>&nbsp;
<i>804</i>&nbsp;    /**
<i>805</i>&nbsp;     * Sets the stored fields to load and return as part of the search request. If none
<i>806</i>&nbsp;     * are specified, the source of the document will be returned.
<i>807</i>&nbsp;     */
<i>808</i>&nbsp;    public SearchSourceBuilder storedFields(List&lt;String&gt; fields) {
<b class="nc"><i>809</i>&nbsp;        if (storedFieldsContext == null) {</b>
<b class="nc"><i>810</i>&nbsp;            storedFieldsContext = StoredFieldsContext.fromList(fields);</b>
<i>811</i>&nbsp;        } else {
<b class="nc"><i>812</i>&nbsp;            storedFieldsContext.addFieldNames(fields);</b>
<i>813</i>&nbsp;        }
<b class="nc"><i>814</i>&nbsp;        return this;</b>
<i>815</i>&nbsp;    }
<i>816</i>&nbsp;
<i>817</i>&nbsp;    /**
<i>818</i>&nbsp;     * Indicates how the stored fields should be fetched.
<i>819</i>&nbsp;     */
<i>820</i>&nbsp;    public SearchSourceBuilder storedFields(StoredFieldsContext context) {
<b class="nc"><i>821</i>&nbsp;        storedFieldsContext = context;</b>
<b class="nc"><i>822</i>&nbsp;        return this;</b>
<i>823</i>&nbsp;    }
<i>824</i>&nbsp;
<i>825</i>&nbsp;    /**
<i>826</i>&nbsp;     * Gets the stored fields context.
<i>827</i>&nbsp;     */
<i>828</i>&nbsp;    public StoredFieldsContext storedFields() {
<b class="nc"><i>829</i>&nbsp;        return storedFieldsContext;</b>
<i>830</i>&nbsp;    }
<i>831</i>&nbsp;
<i>832</i>&nbsp;    /**
<i>833</i>&nbsp;     * Gets the docvalue fields.
<i>834</i>&nbsp;     */
<i>835</i>&nbsp;    public List&lt;FieldAndFormat&gt; docValueFields() {
<b class="nc"><i>836</i>&nbsp;        return docValueFields;</b>
<i>837</i>&nbsp;    }
<i>838</i>&nbsp;
<i>839</i>&nbsp;    /**
<i>840</i>&nbsp;     * Adds a field to load from the doc values and return as part of the
<i>841</i>&nbsp;     * search request.
<i>842</i>&nbsp;     */
<i>843</i>&nbsp;    public SearchSourceBuilder docValueField(String name, @Nullable String format) {
<b class="nc"><i>844</i>&nbsp;        if (docValueFields == null) {</b>
<b class="nc"><i>845</i>&nbsp;            docValueFields = new ArrayList&lt;&gt;();</b>
<i>846</i>&nbsp;        }
<b class="nc"><i>847</i>&nbsp;        docValueFields.add(new FieldAndFormat(name, format));</b>
<b class="nc"><i>848</i>&nbsp;        return this;</b>
<i>849</i>&nbsp;    }
<i>850</i>&nbsp;
<i>851</i>&nbsp;    /**
<i>852</i>&nbsp;     * Adds a field to load from the doc values and return as part of the
<i>853</i>&nbsp;     * search request.
<i>854</i>&nbsp;     */
<i>855</i>&nbsp;    public SearchSourceBuilder docValueField(String name) {
<b class="nc"><i>856</i>&nbsp;        return docValueField(name, null);</b>
<i>857</i>&nbsp;    }
<i>858</i>&nbsp;
<i>859</i>&nbsp;    /**
<i>860</i>&nbsp;     * Adds a script field under the given name with the provided script.
<i>861</i>&nbsp;     *
<i>862</i>&nbsp;     * @param name
<i>863</i>&nbsp;     *            The name of the field
<i>864</i>&nbsp;     * @param script
<i>865</i>&nbsp;     *            The script
<i>866</i>&nbsp;     */
<i>867</i>&nbsp;    public SearchSourceBuilder scriptField(String name, Script script) {
<b class="nc"><i>868</i>&nbsp;        scriptField(name, script, false);</b>
<b class="nc"><i>869</i>&nbsp;        return this;</b>
<i>870</i>&nbsp;    }
<i>871</i>&nbsp;
<i>872</i>&nbsp;    /**
<i>873</i>&nbsp;     * Adds a script field under the given name with the provided script.
<i>874</i>&nbsp;     *
<i>875</i>&nbsp;     * @param name
<i>876</i>&nbsp;     *            The name of the field
<i>877</i>&nbsp;     * @param script
<i>878</i>&nbsp;     *            The script
<i>879</i>&nbsp;     */
<i>880</i>&nbsp;    public SearchSourceBuilder scriptField(String name, Script script, boolean ignoreFailure) {
<b class="nc"><i>881</i>&nbsp;        if (scriptFields == null) {</b>
<b class="nc"><i>882</i>&nbsp;            scriptFields = new ArrayList&lt;&gt;();</b>
<i>883</i>&nbsp;        }
<b class="nc"><i>884</i>&nbsp;        scriptFields.add(new ScriptField(name, script, ignoreFailure));</b>
<b class="nc"><i>885</i>&nbsp;        return this;</b>
<i>886</i>&nbsp;    }
<i>887</i>&nbsp;
<i>888</i>&nbsp;    /**
<i>889</i>&nbsp;     * Gets the script fields.
<i>890</i>&nbsp;     */
<i>891</i>&nbsp;    public List&lt;ScriptField&gt; scriptFields() {
<b class="nc"><i>892</i>&nbsp;        return scriptFields;</b>
<i>893</i>&nbsp;    }
<i>894</i>&nbsp;
<i>895</i>&nbsp;    /**
<i>896</i>&nbsp;     * Sets the boost a specific index or alias will receive when the query is executed
<i>897</i>&nbsp;     * against it.
<i>898</i>&nbsp;     *
<i>899</i>&nbsp;     * @param index
<i>900</i>&nbsp;     *            The index or alias to apply the boost against
<i>901</i>&nbsp;     * @param indexBoost
<i>902</i>&nbsp;     *            The boost to apply to the index
<i>903</i>&nbsp;     */
<i>904</i>&nbsp;    public SearchSourceBuilder indexBoost(String index, float indexBoost) {
<b class="nc"><i>905</i>&nbsp;        Objects.requireNonNull(index, &quot;index must not be null&quot;);</b>
<b class="nc"><i>906</i>&nbsp;        this.indexBoosts.add(new IndexBoost(index, indexBoost));</b>
<b class="nc"><i>907</i>&nbsp;        return this;</b>
<i>908</i>&nbsp;    }
<i>909</i>&nbsp;
<i>910</i>&nbsp;    /**
<i>911</i>&nbsp;     * Gets the boost a specific indices or aliases will receive when the query is
<i>912</i>&nbsp;     * executed against them.
<i>913</i>&nbsp;     */
<i>914</i>&nbsp;    public List&lt;IndexBoost&gt; indexBoosts() {
<b class="nc"><i>915</i>&nbsp;        return indexBoosts;</b>
<i>916</i>&nbsp;    }
<i>917</i>&nbsp;
<i>918</i>&nbsp;    /**
<i>919</i>&nbsp;     * The stats groups this request will be aggregated under.
<i>920</i>&nbsp;     */
<i>921</i>&nbsp;    public SearchSourceBuilder stats(List&lt;String&gt; statsGroups) {
<b class="nc"><i>922</i>&nbsp;        this.stats = statsGroups;</b>
<b class="nc"><i>923</i>&nbsp;        return this;</b>
<i>924</i>&nbsp;    }
<i>925</i>&nbsp;
<i>926</i>&nbsp;    /**
<i>927</i>&nbsp;     * The stats groups this request will be aggregated under.
<i>928</i>&nbsp;     */
<i>929</i>&nbsp;    public List&lt;String&gt; stats() {
<b class="nc"><i>930</i>&nbsp;        return stats;</b>
<i>931</i>&nbsp;    }
<i>932</i>&nbsp;
<i>933</i>&nbsp;    public SearchSourceBuilder ext(List&lt;SearchExtBuilder&gt; searchExtBuilders) {
<b class="nc"><i>934</i>&nbsp;        this.extBuilders = Objects.requireNonNull(searchExtBuilders, &quot;searchExtBuilders must not be null&quot;);</b>
<b class="nc"><i>935</i>&nbsp;        return this;</b>
<i>936</i>&nbsp;    }
<i>937</i>&nbsp;
<i>938</i>&nbsp;    public List&lt;SearchExtBuilder&gt; ext() {
<b class="nc"><i>939</i>&nbsp;        return extBuilders;</b>
<i>940</i>&nbsp;    }
<i>941</i>&nbsp;
<i>942</i>&nbsp;    /**
<i>943</i>&nbsp;     * @return true if the source only has suggest
<i>944</i>&nbsp;     */
<i>945</i>&nbsp;    public boolean isSuggestOnly() {
<b class="nc"><i>946</i>&nbsp;        return suggestBuilder != null</b>
<i>947</i>&nbsp;            &amp;&amp; queryBuilder == null &amp;&amp; aggregations == null;
<i>948</i>&nbsp;    }
<i>949</i>&nbsp;
<i>950</i>&nbsp;    /**
<i>951</i>&nbsp;     * Rewrites this search source builder into its primitive form. e.g. by
<i>952</i>&nbsp;     * rewriting the QueryBuilder. If the builder did not change the identity
<i>953</i>&nbsp;     * reference must be returned otherwise the builder will be rewritten
<i>954</i>&nbsp;     * infinitely.
<i>955</i>&nbsp;     */
<i>956</i>&nbsp;    @Override
<i>957</i>&nbsp;    public SearchSourceBuilder rewrite(QueryRewriteContext context) throws IOException {
<b class="nc"><i>958</i>&nbsp;        assert (this.equals(shallowCopy(queryBuilder, postQueryBuilder, aggregations, sliceBuilder, sorts, rescoreBuilders,</b>
<i>959</i>&nbsp;            highlightBuilder)));
<b class="nc"><i>960</i>&nbsp;        QueryBuilder queryBuilder = null;</b>
<b class="nc"><i>961</i>&nbsp;        if (this.queryBuilder != null) {</b>
<b class="nc"><i>962</i>&nbsp;            queryBuilder = this.queryBuilder.rewrite(context);</b>
<i>963</i>&nbsp;        }
<b class="nc"><i>964</i>&nbsp;        QueryBuilder postQueryBuilder = null;</b>
<b class="nc"><i>965</i>&nbsp;        if (this.postQueryBuilder != null) {</b>
<b class="nc"><i>966</i>&nbsp;            postQueryBuilder = this.postQueryBuilder.rewrite(context);</b>
<i>967</i>&nbsp;        }
<b class="nc"><i>968</i>&nbsp;        AggregatorFactories.Builder aggregations = null;</b>
<b class="nc"><i>969</i>&nbsp;        if (this.aggregations != null) {</b>
<b class="nc"><i>970</i>&nbsp;            aggregations = this.aggregations.rewrite(context);</b>
<i>971</i>&nbsp;        }
<b class="nc"><i>972</i>&nbsp;        List&lt;SortBuilder&lt;?&gt;&gt; sorts = Rewriteable.rewrite(this.sorts, context);</b>
<i>973</i>&nbsp;
<b class="nc"><i>974</i>&nbsp;        List&lt;RescorerBuilder&gt; rescoreBuilders = Rewriteable.rewrite(this.rescoreBuilders, context);</b>
<b class="nc"><i>975</i>&nbsp;        HighlightBuilder highlightBuilder = this.highlightBuilder;</b>
<b class="nc"><i>976</i>&nbsp;        if (highlightBuilder != null) {</b>
<b class="nc"><i>977</i>&nbsp;            highlightBuilder = this.highlightBuilder.rewrite(context);</b>
<i>978</i>&nbsp;        }
<i>979</i>&nbsp;
<b class="nc"><i>980</i>&nbsp;        boolean rewritten = queryBuilder != this.queryBuilder || postQueryBuilder != this.postQueryBuilder</b>
<i>981</i>&nbsp;                || aggregations != this.aggregations || rescoreBuilders != this.rescoreBuilders || sorts != this.sorts ||
<i>982</i>&nbsp;                this.highlightBuilder != highlightBuilder;
<b class="nc"><i>983</i>&nbsp;        if (rewritten) {</b>
<b class="nc"><i>984</i>&nbsp;            return shallowCopy(queryBuilder, postQueryBuilder, aggregations, this.sliceBuilder, sorts, rescoreBuilders, highlightBuilder);</b>
<i>985</i>&nbsp;        }
<b class="nc"><i>986</i>&nbsp;        return this;</b>
<i>987</i>&nbsp;    }
<i>988</i>&nbsp;
<i>989</i>&nbsp;    /**
<i>990</i>&nbsp;     * Create a shallow copy of this builder with a new slice configuration.
<i>991</i>&nbsp;     */
<i>992</i>&nbsp;    public SearchSourceBuilder copyWithNewSlice(SliceBuilder slice) {
<b class="nc"><i>993</i>&nbsp;        return shallowCopy(queryBuilder, postQueryBuilder, aggregations, slice, sorts, rescoreBuilders, highlightBuilder);</b>
<i>994</i>&nbsp;    }
<i>995</i>&nbsp;
<i>996</i>&nbsp;    /**
<i>997</i>&nbsp;     * Create a shallow copy of this source replaced {@link #queryBuilder}, {@link #postQueryBuilder}, and {@link #sliceBuilder}. Used by
<i>998</i>&nbsp;     * {@link #rewrite(QueryRewriteContext)} and {@link #copyWithNewSlice(SliceBuilder)}.
<i>999</i>&nbsp;     */
<i>1000</i>&nbsp;    private SearchSourceBuilder shallowCopy(QueryBuilder queryBuilder, QueryBuilder postQueryBuilder,
<i>1001</i>&nbsp;                                            AggregatorFactories.Builder aggregations, SliceBuilder slice, List&lt;SortBuilder&lt;?&gt;&gt; sorts,
<i>1002</i>&nbsp;                                            List&lt;RescorerBuilder&gt; rescoreBuilders, HighlightBuilder highlightBuilder) {
<b class="nc"><i>1003</i>&nbsp;        SearchSourceBuilder rewrittenBuilder = new SearchSourceBuilder();</b>
<b class="nc"><i>1004</i>&nbsp;        rewrittenBuilder.aggregations = aggregations;</b>
<b class="nc"><i>1005</i>&nbsp;        rewrittenBuilder.explain = explain;</b>
<b class="nc"><i>1006</i>&nbsp;        rewrittenBuilder.extBuilders = extBuilders;</b>
<b class="nc"><i>1007</i>&nbsp;        rewrittenBuilder.fetchSourceContext = fetchSourceContext;</b>
<b class="nc"><i>1008</i>&nbsp;        rewrittenBuilder.docValueFields = docValueFields;</b>
<b class="nc"><i>1009</i>&nbsp;        rewrittenBuilder.storedFieldsContext = storedFieldsContext;</b>
<b class="nc"><i>1010</i>&nbsp;        rewrittenBuilder.from = from;</b>
<b class="nc"><i>1011</i>&nbsp;        rewrittenBuilder.highlightBuilder = highlightBuilder;</b>
<b class="nc"><i>1012</i>&nbsp;        rewrittenBuilder.indexBoosts = indexBoosts;</b>
<b class="nc"><i>1013</i>&nbsp;        rewrittenBuilder.minScore = minScore;</b>
<b class="nc"><i>1014</i>&nbsp;        rewrittenBuilder.postQueryBuilder = postQueryBuilder;</b>
<b class="nc"><i>1015</i>&nbsp;        rewrittenBuilder.profile = profile;</b>
<b class="nc"><i>1016</i>&nbsp;        rewrittenBuilder.queryBuilder = queryBuilder;</b>
<b class="nc"><i>1017</i>&nbsp;        rewrittenBuilder.rescoreBuilders = rescoreBuilders;</b>
<b class="nc"><i>1018</i>&nbsp;        rewrittenBuilder.scriptFields = scriptFields;</b>
<b class="nc"><i>1019</i>&nbsp;        rewrittenBuilder.searchAfterBuilder = searchAfterBuilder;</b>
<b class="nc"><i>1020</i>&nbsp;        rewrittenBuilder.sliceBuilder = slice;</b>
<b class="nc"><i>1021</i>&nbsp;        rewrittenBuilder.size = size;</b>
<b class="nc"><i>1022</i>&nbsp;        rewrittenBuilder.sorts = sorts;</b>
<b class="nc"><i>1023</i>&nbsp;        rewrittenBuilder.stats = stats;</b>
<b class="nc"><i>1024</i>&nbsp;        rewrittenBuilder.suggestBuilder = suggestBuilder;</b>
<b class="nc"><i>1025</i>&nbsp;        rewrittenBuilder.terminateAfter = terminateAfter;</b>
<b class="nc"><i>1026</i>&nbsp;        rewrittenBuilder.timeout = timeout;</b>
<b class="nc"><i>1027</i>&nbsp;        rewrittenBuilder.trackScores = trackScores;</b>
<b class="nc"><i>1028</i>&nbsp;        rewrittenBuilder.trackTotalHitsUpTo = trackTotalHitsUpTo;</b>
<b class="nc"><i>1029</i>&nbsp;        rewrittenBuilder.version = version;</b>
<b class="nc"><i>1030</i>&nbsp;        rewrittenBuilder.seqNoAndPrimaryTerm = seqNoAndPrimaryTerm;</b>
<b class="nc"><i>1031</i>&nbsp;        rewrittenBuilder.collapse = collapse;</b>
<b class="nc"><i>1032</i>&nbsp;        return rewrittenBuilder;</b>
<i>1033</i>&nbsp;    }
<i>1034</i>&nbsp;
<i>1035</i>&nbsp;    public void parseXContent(XContentParser parser) throws IOException {
<b class="nc"><i>1036</i>&nbsp;        parseXContent(parser, true);</b>
<b class="nc"><i>1037</i>&nbsp;    }</b>
<i>1038</i>&nbsp;
<i>1039</i>&nbsp;    /**
<i>1040</i>&nbsp;     * Parse some xContent into this SearchSourceBuilder, overwriting any values specified in the xContent. Use this if you need to set up
<i>1041</i>&nbsp;     * different defaults than a regular SearchSourceBuilder would have and use {@link #fromXContent(XContentParser, boolean)} if you have
<i>1042</i>&nbsp;     * normal defaults.
<i>1043</i>&nbsp;     *
<i>1044</i>&nbsp;     * @param parser The xContent parser.
<i>1045</i>&nbsp;     * @param checkTrailingTokens If true throws a parsing exception when extra tokens are found after the main object.
<i>1046</i>&nbsp;     */
<i>1047</i>&nbsp;    public void parseXContent(XContentParser parser, boolean checkTrailingTokens) throws IOException {
<b class="nc"><i>1048</i>&nbsp;        XContentParser.Token token = parser.currentToken();</b>
<b class="nc"><i>1049</i>&nbsp;        String currentFieldName = null;</b>
<b class="nc"><i>1050</i>&nbsp;        if (token != XContentParser.Token.START_OBJECT &amp;&amp; (token = parser.nextToken()) != XContentParser.Token.START_OBJECT) {</b>
<b class="nc"><i>1051</i>&nbsp;            throw new ParsingException(parser.getTokenLocation(), &quot;Expected [&quot; + XContentParser.Token.START_OBJECT +</b>
<b class="nc"><i>1052</i>&nbsp;                    &quot;] but found [&quot; + token + &quot;]&quot;, parser.getTokenLocation());</b>
<i>1053</i>&nbsp;        }
<b class="nc"><i>1054</i>&nbsp;        while ((token = parser.nextToken()) != XContentParser.Token.END_OBJECT) {</b>
<b class="nc"><i>1055</i>&nbsp;            if (token == XContentParser.Token.FIELD_NAME) {</b>
<b class="nc"><i>1056</i>&nbsp;                currentFieldName = parser.currentName();</b>
<b class="nc"><i>1057</i>&nbsp;            } else if (token.isValue()) {</b>
<b class="nc"><i>1058</i>&nbsp;                if (FROM_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1059</i>&nbsp;                    from = parser.intValue();</b>
<b class="nc"><i>1060</i>&nbsp;                } else if (SIZE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1061</i>&nbsp;                    size = parser.intValue();</b>
<b class="nc"><i>1062</i>&nbsp;                } else if (TIMEOUT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1063</i>&nbsp;                    timeout = TimeValue.parseTimeValue(parser.text(), null, TIMEOUT_FIELD.getPreferredName());</b>
<b class="nc"><i>1064</i>&nbsp;                } else if (TERMINATE_AFTER_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1065</i>&nbsp;                    terminateAfter = parser.intValue();</b>
<b class="nc"><i>1066</i>&nbsp;                } else if (MIN_SCORE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1067</i>&nbsp;                    minScore = parser.floatValue();</b>
<b class="nc"><i>1068</i>&nbsp;                } else if (VERSION_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1069</i>&nbsp;                    version = parser.booleanValue();</b>
<b class="nc"><i>1070</i>&nbsp;                } else if (SEQ_NO_PRIMARY_TERM_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1071</i>&nbsp;                    seqNoAndPrimaryTerm = parser.booleanValue();</b>
<b class="nc"><i>1072</i>&nbsp;                } else if (EXPLAIN_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1073</i>&nbsp;                    explain = parser.booleanValue();</b>
<b class="nc"><i>1074</i>&nbsp;                } else if (TRACK_SCORES_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1075</i>&nbsp;                    trackScores = parser.booleanValue();</b>
<b class="nc"><i>1076</i>&nbsp;                } else if (TRACK_TOTAL_HITS_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1077</i>&nbsp;                    if (token == XContentParser.Token.VALUE_BOOLEAN ||</b>
<b class="nc"><i>1078</i>&nbsp;                        (token == XContentParser.Token.VALUE_STRING &amp;&amp; Booleans.isBoolean(parser.text()))) {</b>
<b class="nc"><i>1079</i>&nbsp;                        trackTotalHitsUpTo = parser.booleanValue() ? TRACK_TOTAL_HITS_ACCURATE : TRACK_TOTAL_HITS_DISABLED;</b>
<i>1080</i>&nbsp;                    } else {
<b class="nc"><i>1081</i>&nbsp;                        trackTotalHitsUpTo = parser.intValue();</b>
<i>1082</i>&nbsp;                    }
<b class="nc"><i>1083</i>&nbsp;                } else if (_SOURCE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1084</i>&nbsp;                    fetchSourceContext = FetchSourceContext.fromXContent(parser);</b>
<b class="nc"><i>1085</i>&nbsp;                } else if (STORED_FIELDS_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1086</i>&nbsp;                    storedFieldsContext =</b>
<b class="nc"><i>1087</i>&nbsp;                        StoredFieldsContext.fromXContent(SearchSourceBuilder.STORED_FIELDS_FIELD.getPreferredName(), parser);</b>
<b class="nc"><i>1088</i>&nbsp;                } else if (SORT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1089</i>&nbsp;                    sort(parser.text());</b>
<b class="nc"><i>1090</i>&nbsp;                } else if (PROFILE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1091</i>&nbsp;                    profile = parser.booleanValue();</b>
<i>1092</i>&nbsp;                } else {
<b class="nc"><i>1093</i>&nbsp;                    throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token + &quot; in [&quot; + currentFieldName + &quot;].&quot;,</b>
<b class="nc"><i>1094</i>&nbsp;                            parser.getTokenLocation());</b>
<i>1095</i>&nbsp;                }
<b class="nc"><i>1096</i>&nbsp;            } else if (token == XContentParser.Token.START_OBJECT) {</b>
<b class="nc"><i>1097</i>&nbsp;                if (QUERY_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1098</i>&nbsp;                    queryBuilder = parseInnerQueryBuilder(parser);</b>
<b class="nc"><i>1099</i>&nbsp;                } else if (POST_FILTER_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1100</i>&nbsp;                    postQueryBuilder = parseInnerQueryBuilder(parser);</b>
<b class="nc"><i>1101</i>&nbsp;                } else if (_SOURCE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1102</i>&nbsp;                    fetchSourceContext = FetchSourceContext.fromXContent(parser);</b>
<b class="nc"><i>1103</i>&nbsp;                } else if (SCRIPT_FIELDS_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1104</i>&nbsp;                    scriptFields = new ArrayList&lt;&gt;();</b>
<b class="nc"><i>1105</i>&nbsp;                    while ((token = parser.nextToken()) != XContentParser.Token.END_OBJECT) {</b>
<b class="nc"><i>1106</i>&nbsp;                        scriptFields.add(new ScriptField(parser));</b>
<i>1107</i>&nbsp;                    }
<b class="nc"><i>1108</i>&nbsp;                } else if (INDICES_BOOST_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1109</i>&nbsp;                    deprecationLogger.deprecated(</b>
<i>1110</i>&nbsp;                        &quot;Object format in indices_boost is deprecated, please use array format instead&quot;);
<b class="nc"><i>1111</i>&nbsp;                    while ((token = parser.nextToken()) != XContentParser.Token.END_OBJECT) {</b>
<b class="nc"><i>1112</i>&nbsp;                        if (token == XContentParser.Token.FIELD_NAME) {</b>
<b class="nc"><i>1113</i>&nbsp;                            currentFieldName = parser.currentName();</b>
<b class="nc"><i>1114</i>&nbsp;                        } else if (token.isValue()) {</b>
<b class="nc"><i>1115</i>&nbsp;                            indexBoosts.add(new IndexBoost(currentFieldName, parser.floatValue()));</b>
<i>1116</i>&nbsp;                        } else {
<b class="nc"><i>1117</i>&nbsp;                            throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token +</b>
<b class="nc"><i>1118</i>&nbsp;                                &quot; in [&quot; + currentFieldName + &quot;].&quot;, parser.getTokenLocation());</b>
<i>1119</i>&nbsp;                        }
<i>1120</i>&nbsp;                    }
<b class="nc"><i>1121</i>&nbsp;                } else if (AGGREGATIONS_FIELD.match(currentFieldName, parser.getDeprecationHandler())</b>
<b class="nc"><i>1122</i>&nbsp;                        || AGGS_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1123</i>&nbsp;                    aggregations = AggregatorFactories.parseAggregators(parser);</b>
<b class="nc"><i>1124</i>&nbsp;                } else if (HIGHLIGHT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1125</i>&nbsp;                    highlightBuilder = HighlightBuilder.fromXContent(parser);</b>
<b class="nc"><i>1126</i>&nbsp;                } else if (SUGGEST_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1127</i>&nbsp;                    suggestBuilder = SuggestBuilder.fromXContent(parser);</b>
<b class="nc"><i>1128</i>&nbsp;                } else if (SORT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1129</i>&nbsp;                    sorts = new ArrayList&lt;&gt;(SortBuilder.fromXContent(parser));</b>
<b class="nc"><i>1130</i>&nbsp;                } else if (RESCORE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1131</i>&nbsp;                    rescoreBuilders = new ArrayList&lt;&gt;();</b>
<b class="nc"><i>1132</i>&nbsp;                    rescoreBuilders.add(RescorerBuilder.parseFromXContent(parser));</b>
<b class="nc"><i>1133</i>&nbsp;                } else if (EXT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1134</i>&nbsp;                    extBuilders = new ArrayList&lt;&gt;();</b>
<b class="nc"><i>1135</i>&nbsp;                    String extSectionName = null;</b>
<b class="nc"><i>1136</i>&nbsp;                    while ((token = parser.nextToken()) != XContentParser.Token.END_OBJECT) {</b>
<b class="nc"><i>1137</i>&nbsp;                        if (token == XContentParser.Token.FIELD_NAME) {</b>
<b class="nc"><i>1138</i>&nbsp;                            extSectionName = parser.currentName();</b>
<i>1139</i>&nbsp;                        } else {
<b class="nc"><i>1140</i>&nbsp;                            SearchExtBuilder searchExtBuilder = parser.namedObject(SearchExtBuilder.class, extSectionName, null);</b>
<b class="nc"><i>1141</i>&nbsp;                            if (searchExtBuilder.getWriteableName().equals(extSectionName) == false) {</b>
<b class="nc"><i>1142</i>&nbsp;                                throw new IllegalStateException(&quot;The parsed [&quot; + searchExtBuilder.getClass().getName() + &quot;] object has a &quot;</b>
<i>1143</i>&nbsp;                                        + &quot;different writeable name compared to the name of the section that it was parsed from: found [&quot;
<b class="nc"><i>1144</i>&nbsp;                                        + searchExtBuilder.getWriteableName() + &quot;] expected [&quot; + extSectionName + &quot;]&quot;);</b>
<i>1145</i>&nbsp;                            }
<b class="nc"><i>1146</i>&nbsp;                            extBuilders.add(searchExtBuilder);</b>
<b class="nc"><i>1147</i>&nbsp;                        }</b>
<i>1148</i>&nbsp;                    }
<b class="nc"><i>1149</i>&nbsp;                } else if (SLICE.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1150</i>&nbsp;                    sliceBuilder = SliceBuilder.fromXContent(parser);</b>
<b class="nc"><i>1151</i>&nbsp;                } else if (COLLAPSE.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1152</i>&nbsp;                    collapse = CollapseBuilder.fromXContent(parser);</b>
<i>1153</i>&nbsp;                } else {
<b class="nc"><i>1154</i>&nbsp;                    throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token + &quot; in [&quot; + currentFieldName + &quot;].&quot;,</b>
<b class="nc"><i>1155</i>&nbsp;                            parser.getTokenLocation());</b>
<i>1156</i>&nbsp;                }
<b class="nc"><i>1157</i>&nbsp;            } else if (token == XContentParser.Token.START_ARRAY) {</b>
<b class="nc"><i>1158</i>&nbsp;                if (STORED_FIELDS_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1159</i>&nbsp;                    storedFieldsContext = StoredFieldsContext.fromXContent(STORED_FIELDS_FIELD.getPreferredName(), parser);</b>
<b class="nc"><i>1160</i>&nbsp;                } else if (DOCVALUE_FIELDS_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1161</i>&nbsp;                    docValueFields = new ArrayList&lt;&gt;();</b>
<b class="nc"><i>1162</i>&nbsp;                    while ((token = parser.nextToken()) != XContentParser.Token.END_ARRAY) {</b>
<b class="nc"><i>1163</i>&nbsp;                        docValueFields.add(FieldAndFormat.fromXContent(parser));</b>
<i>1164</i>&nbsp;                    }
<b class="nc"><i>1165</i>&nbsp;                } else if (INDICES_BOOST_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1166</i>&nbsp;                    while ((token = parser.nextToken()) != XContentParser.Token.END_ARRAY) {</b>
<b class="nc"><i>1167</i>&nbsp;                        indexBoosts.add(new IndexBoost(parser));</b>
<i>1168</i>&nbsp;                    }
<b class="nc"><i>1169</i>&nbsp;                } else if (SORT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1170</i>&nbsp;                    sorts = new ArrayList&lt;&gt;(SortBuilder.fromXContent(parser));</b>
<b class="nc"><i>1171</i>&nbsp;                } else if (RESCORE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1172</i>&nbsp;                    rescoreBuilders = new ArrayList&lt;&gt;();</b>
<b class="nc"><i>1173</i>&nbsp;                    while ((token = parser.nextToken()) != XContentParser.Token.END_ARRAY) {</b>
<b class="nc"><i>1174</i>&nbsp;                        rescoreBuilders.add(RescorerBuilder.parseFromXContent(parser));</b>
<i>1175</i>&nbsp;                    }
<b class="nc"><i>1176</i>&nbsp;                } else if (STATS_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1177</i>&nbsp;                    stats = new ArrayList&lt;&gt;();</b>
<b class="nc"><i>1178</i>&nbsp;                    while ((token = parser.nextToken()) != XContentParser.Token.END_ARRAY) {</b>
<b class="nc"><i>1179</i>&nbsp;                        if (token == XContentParser.Token.VALUE_STRING) {</b>
<b class="nc"><i>1180</i>&nbsp;                            stats.add(parser.text());</b>
<i>1181</i>&nbsp;                        } else {
<b class="nc"><i>1182</i>&nbsp;                            throw new ParsingException(parser.getTokenLocation(), &quot;Expected [&quot; + XContentParser.Token.VALUE_STRING +</b>
<b class="nc"><i>1183</i>&nbsp;                                    &quot;] in [&quot; + currentFieldName + &quot;] but found [&quot; + token + &quot;]&quot;, parser.getTokenLocation());</b>
<i>1184</i>&nbsp;                        }
<i>1185</i>&nbsp;                    }
<b class="nc"><i>1186</i>&nbsp;                } else if (_SOURCE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1187</i>&nbsp;                    fetchSourceContext = FetchSourceContext.fromXContent(parser);</b>
<b class="nc"><i>1188</i>&nbsp;                } else if (SEARCH_AFTER.match(currentFieldName, parser.getDeprecationHandler())) {</b>
<b class="nc"><i>1189</i>&nbsp;                    searchAfterBuilder = SearchAfterBuilder.fromXContent(parser);</b>
<i>1190</i>&nbsp;                } else {
<b class="nc"><i>1191</i>&nbsp;                    throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token + &quot; in [&quot; + currentFieldName + &quot;].&quot;,</b>
<b class="nc"><i>1192</i>&nbsp;                            parser.getTokenLocation());</b>
<i>1193</i>&nbsp;                }
<i>1194</i>&nbsp;            } else {
<b class="nc"><i>1195</i>&nbsp;                throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token + &quot; in [&quot; + currentFieldName + &quot;].&quot;,</b>
<b class="nc"><i>1196</i>&nbsp;                        parser.getTokenLocation());</b>
<i>1197</i>&nbsp;            }
<i>1198</i>&nbsp;        }
<b class="nc"><i>1199</i>&nbsp;        if (checkTrailingTokens) {</b>
<b class="nc"><i>1200</i>&nbsp;            token = parser.nextToken();</b>
<b class="nc"><i>1201</i>&nbsp;            if (token != null) {</b>
<b class="nc"><i>1202</i>&nbsp;                throw new ParsingException(parser.getTokenLocation(), &quot;Unexpected token [&quot; + token + &quot;] found after the main object.&quot;);</b>
<i>1203</i>&nbsp;            }
<i>1204</i>&nbsp;        }
<b class="nc"><i>1205</i>&nbsp;    }</b>
<i>1206</i>&nbsp;
<i>1207</i>&nbsp;    public XContentBuilder innerToXContent(XContentBuilder builder, Params params) throws IOException {
<b class="nc"><i>1208</i>&nbsp;        if (from != -1) {</b>
<b class="nc"><i>1209</i>&nbsp;            builder.field(FROM_FIELD.getPreferredName(), from);</b>
<i>1210</i>&nbsp;        }
<b class="nc"><i>1211</i>&nbsp;        if (size != -1) {</b>
<b class="nc"><i>1212</i>&nbsp;            builder.field(SIZE_FIELD.getPreferredName(), size);</b>
<i>1213</i>&nbsp;        }
<i>1214</i>&nbsp;
<b class="nc"><i>1215</i>&nbsp;        if (timeout != null &amp;&amp; !timeout.equals(TimeValue.MINUS_ONE)) {</b>
<b class="nc"><i>1216</i>&nbsp;            builder.field(TIMEOUT_FIELD.getPreferredName(), timeout.getStringRep());</b>
<i>1217</i>&nbsp;        }
<i>1218</i>&nbsp;
<b class="nc"><i>1219</i>&nbsp;        if (terminateAfter != SearchContext.DEFAULT_TERMINATE_AFTER) {</b>
<b class="nc"><i>1220</i>&nbsp;            builder.field(TERMINATE_AFTER_FIELD.getPreferredName(), terminateAfter);</b>
<i>1221</i>&nbsp;        }
<i>1222</i>&nbsp;
<b class="nc"><i>1223</i>&nbsp;        if (queryBuilder != null) {</b>
<b class="nc"><i>1224</i>&nbsp;            builder.field(QUERY_FIELD.getPreferredName(), queryBuilder);</b>
<i>1225</i>&nbsp;        }
<i>1226</i>&nbsp;
<b class="nc"><i>1227</i>&nbsp;        if (postQueryBuilder != null) {</b>
<b class="nc"><i>1228</i>&nbsp;            builder.field(POST_FILTER_FIELD.getPreferredName(), postQueryBuilder);</b>
<i>1229</i>&nbsp;        }
<i>1230</i>&nbsp;
<b class="nc"><i>1231</i>&nbsp;        if (minScore != null) {</b>
<b class="nc"><i>1232</i>&nbsp;            builder.field(MIN_SCORE_FIELD.getPreferredName(), minScore);</b>
<i>1233</i>&nbsp;        }
<i>1234</i>&nbsp;
<b class="nc"><i>1235</i>&nbsp;        if (version != null) {</b>
<b class="nc"><i>1236</i>&nbsp;            builder.field(VERSION_FIELD.getPreferredName(), version);</b>
<i>1237</i>&nbsp;        }
<i>1238</i>&nbsp;
<b class="nc"><i>1239</i>&nbsp;        if (seqNoAndPrimaryTerm != null) {</b>
<b class="nc"><i>1240</i>&nbsp;            builder.field(SEQ_NO_PRIMARY_TERM_FIELD.getPreferredName(), seqNoAndPrimaryTerm);</b>
<i>1241</i>&nbsp;        }
<i>1242</i>&nbsp;
<b class="nc"><i>1243</i>&nbsp;        if (explain != null) {</b>
<b class="nc"><i>1244</i>&nbsp;            builder.field(EXPLAIN_FIELD.getPreferredName(), explain);</b>
<i>1245</i>&nbsp;        }
<i>1246</i>&nbsp;
<b class="nc"><i>1247</i>&nbsp;        if (profile) {</b>
<b class="nc"><i>1248</i>&nbsp;            builder.field(&quot;profile&quot;, true);</b>
<i>1249</i>&nbsp;        }
<i>1250</i>&nbsp;
<b class="nc"><i>1251</i>&nbsp;        if (fetchSourceContext != null) {</b>
<b class="nc"><i>1252</i>&nbsp;            builder.field(_SOURCE_FIELD.getPreferredName(), fetchSourceContext);</b>
<i>1253</i>&nbsp;        }
<i>1254</i>&nbsp;
<b class="nc"><i>1255</i>&nbsp;        if (storedFieldsContext != null) {</b>
<b class="nc"><i>1256</i>&nbsp;            storedFieldsContext.toXContent(STORED_FIELDS_FIELD.getPreferredName(), builder);</b>
<i>1257</i>&nbsp;        }
<i>1258</i>&nbsp;
<b class="nc"><i>1259</i>&nbsp;        if (docValueFields != null) {</b>
<b class="nc"><i>1260</i>&nbsp;            builder.startArray(DOCVALUE_FIELDS_FIELD.getPreferredName());</b>
<b class="nc"><i>1261</i>&nbsp;            for (FieldAndFormat docValueField : docValueFields) {</b>
<b class="nc"><i>1262</i>&nbsp;                builder.startObject()</b>
<b class="nc"><i>1263</i>&nbsp;                    .field(&quot;field&quot;, docValueField.field);</b>
<b class="nc"><i>1264</i>&nbsp;                if (docValueField.format != null) {</b>
<b class="nc"><i>1265</i>&nbsp;                    builder.field(&quot;format&quot;, docValueField.format);</b>
<i>1266</i>&nbsp;                }
<b class="nc"><i>1267</i>&nbsp;                builder.endObject();</b>
<b class="nc"><i>1268</i>&nbsp;            }</b>
<b class="nc"><i>1269</i>&nbsp;            builder.endArray();</b>
<i>1270</i>&nbsp;        }
<i>1271</i>&nbsp;
<b class="nc"><i>1272</i>&nbsp;        if (scriptFields != null) {</b>
<b class="nc"><i>1273</i>&nbsp;            builder.startObject(SCRIPT_FIELDS_FIELD.getPreferredName());</b>
<b class="nc"><i>1274</i>&nbsp;            for (ScriptField scriptField : scriptFields) {</b>
<b class="nc"><i>1275</i>&nbsp;                scriptField.toXContent(builder, params);</b>
<b class="nc"><i>1276</i>&nbsp;            }</b>
<b class="nc"><i>1277</i>&nbsp;            builder.endObject();</b>
<i>1278</i>&nbsp;        }
<i>1279</i>&nbsp;
<b class="nc"><i>1280</i>&nbsp;        if (sorts != null) {</b>
<b class="nc"><i>1281</i>&nbsp;            builder.startArray(SORT_FIELD.getPreferredName());</b>
<b class="nc"><i>1282</i>&nbsp;            for (SortBuilder&lt;?&gt; sort : sorts) {</b>
<b class="nc"><i>1283</i>&nbsp;                sort.toXContent(builder, params);</b>
<b class="nc"><i>1284</i>&nbsp;            }</b>
<b class="nc"><i>1285</i>&nbsp;            builder.endArray();</b>
<i>1286</i>&nbsp;        }
<i>1287</i>&nbsp;
<b class="nc"><i>1288</i>&nbsp;        if (trackScores) {</b>
<b class="nc"><i>1289</i>&nbsp;            builder.field(TRACK_SCORES_FIELD.getPreferredName(), true);</b>
<i>1290</i>&nbsp;        }
<i>1291</i>&nbsp;
<b class="nc"><i>1292</i>&nbsp;        if (trackTotalHitsUpTo != null) {</b>
<b class="nc"><i>1293</i>&nbsp;            builder.field(TRACK_TOTAL_HITS_FIELD.getPreferredName(), trackTotalHitsUpTo);</b>
<i>1294</i>&nbsp;        }
<i>1295</i>&nbsp;
<b class="nc"><i>1296</i>&nbsp;        if (searchAfterBuilder != null) {</b>
<b class="nc"><i>1297</i>&nbsp;            builder.array(SEARCH_AFTER.getPreferredName(), searchAfterBuilder.getSortValues());</b>
<i>1298</i>&nbsp;        }
<i>1299</i>&nbsp;
<b class="nc"><i>1300</i>&nbsp;        if (sliceBuilder != null) {</b>
<b class="nc"><i>1301</i>&nbsp;            builder.field(SLICE.getPreferredName(), sliceBuilder);</b>
<i>1302</i>&nbsp;        }
<i>1303</i>&nbsp;
<b class="nc"><i>1304</i>&nbsp;        if (!indexBoosts.isEmpty()) {</b>
<b class="nc"><i>1305</i>&nbsp;            builder.startArray(INDICES_BOOST_FIELD.getPreferredName());</b>
<b class="nc"><i>1306</i>&nbsp;            for (IndexBoost ib : indexBoosts) {</b>
<b class="nc"><i>1307</i>&nbsp;                builder.startObject();</b>
<b class="nc"><i>1308</i>&nbsp;                builder.field(ib.index, ib.boost);</b>
<b class="nc"><i>1309</i>&nbsp;                builder.endObject();</b>
<b class="nc"><i>1310</i>&nbsp;            }</b>
<b class="nc"><i>1311</i>&nbsp;            builder.endArray();</b>
<i>1312</i>&nbsp;        }
<i>1313</i>&nbsp;
<b class="nc"><i>1314</i>&nbsp;        if (aggregations != null) {</b>
<b class="nc"><i>1315</i>&nbsp;            builder.field(AGGREGATIONS_FIELD.getPreferredName(), aggregations);</b>
<i>1316</i>&nbsp;        }
<i>1317</i>&nbsp;
<b class="nc"><i>1318</i>&nbsp;        if (highlightBuilder != null) {</b>
<b class="nc"><i>1319</i>&nbsp;            builder.field(HIGHLIGHT_FIELD.getPreferredName(), highlightBuilder);</b>
<i>1320</i>&nbsp;        }
<i>1321</i>&nbsp;
<b class="nc"><i>1322</i>&nbsp;        if (suggestBuilder != null) {</b>
<b class="nc"><i>1323</i>&nbsp;            builder.field(SUGGEST_FIELD.getPreferredName(), suggestBuilder);</b>
<i>1324</i>&nbsp;        }
<i>1325</i>&nbsp;
<b class="nc"><i>1326</i>&nbsp;        if (rescoreBuilders != null) {</b>
<b class="nc"><i>1327</i>&nbsp;            builder.startArray(RESCORE_FIELD.getPreferredName());</b>
<b class="nc"><i>1328</i>&nbsp;            for (RescorerBuilder&lt;?&gt; rescoreBuilder : rescoreBuilders) {</b>
<b class="nc"><i>1329</i>&nbsp;                rescoreBuilder.toXContent(builder, params);</b>
<b class="nc"><i>1330</i>&nbsp;            }</b>
<b class="nc"><i>1331</i>&nbsp;            builder.endArray();</b>
<i>1332</i>&nbsp;        }
<i>1333</i>&nbsp;
<b class="nc"><i>1334</i>&nbsp;        if (stats != null) {</b>
<b class="nc"><i>1335</i>&nbsp;            builder.field(STATS_FIELD.getPreferredName(), stats);</b>
<i>1336</i>&nbsp;        }
<i>1337</i>&nbsp;
<b class="nc"><i>1338</i>&nbsp;        if (extBuilders != null &amp;&amp; extBuilders.isEmpty() == false) {</b>
<b class="nc"><i>1339</i>&nbsp;            builder.startObject(EXT_FIELD.getPreferredName());</b>
<b class="nc"><i>1340</i>&nbsp;            for (SearchExtBuilder extBuilder : extBuilders) {</b>
<b class="nc"><i>1341</i>&nbsp;                extBuilder.toXContent(builder, params);</b>
<b class="nc"><i>1342</i>&nbsp;            }</b>
<b class="nc"><i>1343</i>&nbsp;            builder.endObject();</b>
<i>1344</i>&nbsp;        }
<i>1345</i>&nbsp;
<b class="nc"><i>1346</i>&nbsp;        if (collapse != null) {</b>
<b class="nc"><i>1347</i>&nbsp;            builder.field(COLLAPSE.getPreferredName(), collapse);</b>
<i>1348</i>&nbsp;        }
<b class="nc"><i>1349</i>&nbsp;        return builder;</b>
<i>1350</i>&nbsp;    }
<i>1351</i>&nbsp;
<i>1352</i>&nbsp;    @Override
<i>1353</i>&nbsp;    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {
<b class="nc"><i>1354</i>&nbsp;        builder.startObject();</b>
<b class="nc"><i>1355</i>&nbsp;        innerToXContent(builder, params);</b>
<b class="nc"><i>1356</i>&nbsp;        builder.endObject();</b>
<b class="nc"><i>1357</i>&nbsp;        return builder;</b>
<i>1358</i>&nbsp;    }
<i>1359</i>&nbsp;
<i>1360</i>&nbsp;    public static class IndexBoost implements Writeable, ToXContentObject {
<i>1361</i>&nbsp;        private final String index;
<i>1362</i>&nbsp;        private final float boost;
<i>1363</i>&nbsp;
<i>1364</i>&nbsp;        IndexBoost(String index, float boost) {
<i>1365</i>&nbsp;            this.index = index;
<i>1366</i>&nbsp;            this.boost = boost;
<i>1367</i>&nbsp;        }
<i>1368</i>&nbsp;
<i>1369</i>&nbsp;        IndexBoost(StreamInput in) throws IOException {
<i>1370</i>&nbsp;            index = in.readString();
<i>1371</i>&nbsp;            boost = in.readFloat();
<i>1372</i>&nbsp;        }
<i>1373</i>&nbsp;
<i>1374</i>&nbsp;        IndexBoost(XContentParser parser) throws IOException {
<i>1375</i>&nbsp;            XContentParser.Token token = parser.currentToken();
<i>1376</i>&nbsp;
<i>1377</i>&nbsp;            if (token == XContentParser.Token.START_OBJECT) {
<i>1378</i>&nbsp;                token = parser.nextToken();
<i>1379</i>&nbsp;                if (token == XContentParser.Token.FIELD_NAME) {
<i>1380</i>&nbsp;                    index = parser.currentName();
<i>1381</i>&nbsp;                } else {
<i>1382</i>&nbsp;                    throw new ParsingException(parser.getTokenLocation(), &quot;Expected [&quot; + XContentParser.Token.FIELD_NAME +
<i>1383</i>&nbsp;                        &quot;] in [&quot; + INDICES_BOOST_FIELD + &quot;] but found [&quot; + token + &quot;]&quot;, parser.getTokenLocation());
<i>1384</i>&nbsp;                }
<i>1385</i>&nbsp;                token = parser.nextToken();
<i>1386</i>&nbsp;                if (token == XContentParser.Token.VALUE_NUMBER) {
<i>1387</i>&nbsp;                    boost = parser.floatValue();
<i>1388</i>&nbsp;                } else {
<i>1389</i>&nbsp;                    throw new ParsingException(parser.getTokenLocation(), &quot;Expected [&quot; + XContentParser.Token.VALUE_NUMBER +
<i>1390</i>&nbsp;                        &quot;] in [&quot; + INDICES_BOOST_FIELD + &quot;] but found [&quot; + token + &quot;]&quot;, parser.getTokenLocation());
<i>1391</i>&nbsp;                }
<i>1392</i>&nbsp;                token = parser.nextToken();
<i>1393</i>&nbsp;                if (token != XContentParser.Token.END_OBJECT) {
<i>1394</i>&nbsp;                    throw new ParsingException(parser.getTokenLocation(), &quot;Expected [&quot; + XContentParser.Token.END_OBJECT +
<i>1395</i>&nbsp;                        &quot;] in [&quot; + INDICES_BOOST_FIELD + &quot;] but found [&quot; + token + &quot;]&quot;, parser.getTokenLocation());
<i>1396</i>&nbsp;                }
<i>1397</i>&nbsp;            } else {
<i>1398</i>&nbsp;                throw new ParsingException(parser.getTokenLocation(), &quot;Expected [&quot; + XContentParser.Token.START_OBJECT +
<i>1399</i>&nbsp;                    &quot;] in [&quot; + parser.currentName() + &quot;] but found [&quot; + token + &quot;]&quot;, parser.getTokenLocation());
<i>1400</i>&nbsp;            }
<i>1401</i>&nbsp;        }
<i>1402</i>&nbsp;
<i>1403</i>&nbsp;        public String getIndex() {
<i>1404</i>&nbsp;            return index;
<i>1405</i>&nbsp;        }
<i>1406</i>&nbsp;
<i>1407</i>&nbsp;        public float getBoost() {
<i>1408</i>&nbsp;            return boost;
<i>1409</i>&nbsp;        }
<i>1410</i>&nbsp;
<i>1411</i>&nbsp;        @Override
<i>1412</i>&nbsp;        public void writeTo(StreamOutput out) throws IOException {
<i>1413</i>&nbsp;            out.writeString(index);
<i>1414</i>&nbsp;            out.writeFloat(boost);
<i>1415</i>&nbsp;        }
<i>1416</i>&nbsp;
<i>1417</i>&nbsp;        @Override
<i>1418</i>&nbsp;        public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {
<i>1419</i>&nbsp;            builder.startObject();
<i>1420</i>&nbsp;            builder.field(index, boost);
<i>1421</i>&nbsp;            builder.endObject();
<i>1422</i>&nbsp;            return builder;
<i>1423</i>&nbsp;        }
<i>1424</i>&nbsp;
<i>1425</i>&nbsp;        @Override
<i>1426</i>&nbsp;        public int hashCode() {
<i>1427</i>&nbsp;            return Objects.hash(index, boost);
<i>1428</i>&nbsp;        }
<i>1429</i>&nbsp;
<i>1430</i>&nbsp;        @Override
<i>1431</i>&nbsp;        public boolean equals(Object obj) {
<i>1432</i>&nbsp;            if (obj == null) {
<i>1433</i>&nbsp;                return false;
<i>1434</i>&nbsp;            }
<i>1435</i>&nbsp;            if (getClass() != obj.getClass()) {
<i>1436</i>&nbsp;                return false;
<i>1437</i>&nbsp;            }
<i>1438</i>&nbsp;            IndexBoost other = (IndexBoost) obj;
<i>1439</i>&nbsp;            return Objects.equals(index, other.index)
<i>1440</i>&nbsp;                &amp;&amp; Objects.equals(boost, other.boost);
<i>1441</i>&nbsp;        }
<i>1442</i>&nbsp;
<i>1443</i>&nbsp;    }
<i>1444</i>&nbsp;
<i>1445</i>&nbsp;    public static class ScriptField implements Writeable, ToXContentFragment {
<i>1446</i>&nbsp;
<i>1447</i>&nbsp;        private final boolean ignoreFailure;
<i>1448</i>&nbsp;        private final String fieldName;
<i>1449</i>&nbsp;        private final Script script;
<i>1450</i>&nbsp;
<i>1451</i>&nbsp;        public ScriptField(String fieldName, Script script, boolean ignoreFailure) {
<i>1452</i>&nbsp;            this.fieldName = fieldName;
<i>1453</i>&nbsp;            this.script = script;
<i>1454</i>&nbsp;            this.ignoreFailure = ignoreFailure;
<i>1455</i>&nbsp;        }
<i>1456</i>&nbsp;
<i>1457</i>&nbsp;        /**
<i>1458</i>&nbsp;         * Read from a stream.
<i>1459</i>&nbsp;         */
<i>1460</i>&nbsp;        public ScriptField(StreamInput in) throws IOException {
<i>1461</i>&nbsp;            fieldName = in.readString();
<i>1462</i>&nbsp;            script = new Script(in);
<i>1463</i>&nbsp;            ignoreFailure = in.readBoolean();
<i>1464</i>&nbsp;        }
<i>1465</i>&nbsp;
<i>1466</i>&nbsp;        @Override
<i>1467</i>&nbsp;        public void writeTo(StreamOutput out) throws IOException {
<i>1468</i>&nbsp;            out.writeString(fieldName);
<i>1469</i>&nbsp;            script.writeTo(out);
<i>1470</i>&nbsp;            out.writeBoolean(ignoreFailure);
<i>1471</i>&nbsp;        }
<i>1472</i>&nbsp;
<i>1473</i>&nbsp;        public ScriptField(XContentParser parser) throws IOException {
<i>1474</i>&nbsp;            boolean ignoreFailure = false;
<i>1475</i>&nbsp;            String scriptFieldName = parser.currentName();
<i>1476</i>&nbsp;            Script script = null;
<i>1477</i>&nbsp;
<i>1478</i>&nbsp;            XContentParser.Token token;
<i>1479</i>&nbsp;            token = parser.nextToken();
<i>1480</i>&nbsp;            if (token == XContentParser.Token.START_OBJECT) {
<i>1481</i>&nbsp;                String currentFieldName = null;
<i>1482</i>&nbsp;                while ((token = parser.nextToken()) != XContentParser.Token.END_OBJECT) {
<i>1483</i>&nbsp;                    if (token == XContentParser.Token.FIELD_NAME) {
<i>1484</i>&nbsp;                        currentFieldName = parser.currentName();
<i>1485</i>&nbsp;                    } else if (token.isValue()) {
<i>1486</i>&nbsp;                        if (SCRIPT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {
<i>1487</i>&nbsp;                            script = Script.parse(parser);
<i>1488</i>&nbsp;                        } else if (IGNORE_FAILURE_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {
<i>1489</i>&nbsp;                            ignoreFailure = parser.booleanValue();
<i>1490</i>&nbsp;                        } else {
<i>1491</i>&nbsp;                            throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token + &quot; in [&quot; + currentFieldName
<i>1492</i>&nbsp;                                    + &quot;].&quot;, parser.getTokenLocation());
<i>1493</i>&nbsp;                        }
<i>1494</i>&nbsp;                    } else if (token == XContentParser.Token.START_OBJECT) {
<i>1495</i>&nbsp;                        if (SCRIPT_FIELD.match(currentFieldName, parser.getDeprecationHandler())) {
<i>1496</i>&nbsp;                            script = Script.parse(parser);
<i>1497</i>&nbsp;                        } else {
<i>1498</i>&nbsp;                            throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token + &quot; in [&quot; + currentFieldName
<i>1499</i>&nbsp;                                    + &quot;].&quot;, parser.getTokenLocation());
<i>1500</i>&nbsp;                        }
<i>1501</i>&nbsp;                    } else {
<i>1502</i>&nbsp;                        throw new ParsingException(parser.getTokenLocation(), &quot;Unknown key for a &quot; + token + &quot; in [&quot; + currentFieldName
<i>1503</i>&nbsp;                                + &quot;].&quot;, parser.getTokenLocation());
<i>1504</i>&nbsp;                    }
<i>1505</i>&nbsp;                }
<i>1506</i>&nbsp;                this.ignoreFailure = ignoreFailure;
<i>1507</i>&nbsp;                this.fieldName = scriptFieldName;
<i>1508</i>&nbsp;                this.script = script;
<i>1509</i>&nbsp;            } else {
<i>1510</i>&nbsp;                throw new ParsingException(parser.getTokenLocation(), &quot;Expected [&quot; + XContentParser.Token.START_OBJECT + &quot;] in [&quot;
<i>1511</i>&nbsp;                        + parser.currentName() + &quot;] but found [&quot; + token + &quot;]&quot;, parser.getTokenLocation());
<i>1512</i>&nbsp;            }
<i>1513</i>&nbsp;        }
<i>1514</i>&nbsp;
<i>1515</i>&nbsp;        public String fieldName() {
<i>1516</i>&nbsp;            return fieldName;
<i>1517</i>&nbsp;        }
<i>1518</i>&nbsp;
<i>1519</i>&nbsp;        public Script script() {
<i>1520</i>&nbsp;            return script;
<i>1521</i>&nbsp;        }
<i>1522</i>&nbsp;
<i>1523</i>&nbsp;        public boolean ignoreFailure() {
<i>1524</i>&nbsp;            return ignoreFailure;
<i>1525</i>&nbsp;        }
<i>1526</i>&nbsp;
<i>1527</i>&nbsp;        @Override
<i>1528</i>&nbsp;        public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {
<i>1529</i>&nbsp;            builder.startObject(fieldName);
<i>1530</i>&nbsp;            builder.field(SCRIPT_FIELD.getPreferredName(), script);
<i>1531</i>&nbsp;            builder.field(IGNORE_FAILURE_FIELD.getPreferredName(), ignoreFailure);
<i>1532</i>&nbsp;            builder.endObject();
<i>1533</i>&nbsp;            return builder;
<i>1534</i>&nbsp;        }
<i>1535</i>&nbsp;
<i>1536</i>&nbsp;        @Override
<i>1537</i>&nbsp;        public int hashCode() {
<i>1538</i>&nbsp;            return Objects.hash(fieldName, script, ignoreFailure);
<i>1539</i>&nbsp;        }
<i>1540</i>&nbsp;
<i>1541</i>&nbsp;        @Override
<i>1542</i>&nbsp;        public boolean equals(Object obj) {
<i>1543</i>&nbsp;            if (obj == null) {
<i>1544</i>&nbsp;                return false;
<i>1545</i>&nbsp;            }
<i>1546</i>&nbsp;            if (getClass() != obj.getClass()) {
<i>1547</i>&nbsp;                return false;
<i>1548</i>&nbsp;            }
<i>1549</i>&nbsp;            ScriptField other = (ScriptField) obj;
<i>1550</i>&nbsp;            return Objects.equals(fieldName, other.fieldName)
<i>1551</i>&nbsp;                    &amp;&amp; Objects.equals(script, other.script)
<i>1552</i>&nbsp;                    &amp;&amp; Objects.equals(ignoreFailure, other.ignoreFailure);
<i>1553</i>&nbsp;        }
<i>1554</i>&nbsp;    }
<i>1555</i>&nbsp;
<i>1556</i>&nbsp;    @Override
<i>1557</i>&nbsp;    public int hashCode() {
<b class="nc"><i>1558</i>&nbsp;        return Objects.hash(aggregations, explain, fetchSourceContext, docValueFields, storedFieldsContext, from, highlightBuilder,</b>
<b class="nc"><i>1559</i>&nbsp;                indexBoosts, minScore, postQueryBuilder, queryBuilder, rescoreBuilders, scriptFields, size,</b>
<b class="nc"><i>1560</i>&nbsp;                sorts, searchAfterBuilder, sliceBuilder, stats, suggestBuilder, terminateAfter, timeout, trackScores, version,</b>
<b class="nc"><i>1561</i>&nbsp;                seqNoAndPrimaryTerm, profile, extBuilders, collapse, trackTotalHitsUpTo);</b>
<i>1562</i>&nbsp;    }
<i>1563</i>&nbsp;
<i>1564</i>&nbsp;    @Override
<i>1565</i>&nbsp;    public boolean equals(Object obj) {
<b class="nc"><i>1566</i>&nbsp;        if (obj == null) {</b>
<b class="nc"><i>1567</i>&nbsp;            return false;</b>
<i>1568</i>&nbsp;        }
<b class="nc"><i>1569</i>&nbsp;        if (obj.getClass() != getClass()) {</b>
<b class="nc"><i>1570</i>&nbsp;            return false;</b>
<i>1571</i>&nbsp;        }
<b class="nc"><i>1572</i>&nbsp;        SearchSourceBuilder other = (SearchSourceBuilder) obj;</b>
<b class="nc"><i>1573</i>&nbsp;        return Objects.equals(aggregations, other.aggregations)</b>
<b class="nc"><i>1574</i>&nbsp;                &amp;&amp; Objects.equals(explain, other.explain)</b>
<b class="nc"><i>1575</i>&nbsp;                &amp;&amp; Objects.equals(fetchSourceContext, other.fetchSourceContext)</b>
<b class="nc"><i>1576</i>&nbsp;                &amp;&amp; Objects.equals(docValueFields, other.docValueFields)</b>
<b class="nc"><i>1577</i>&nbsp;                &amp;&amp; Objects.equals(storedFieldsContext, other.storedFieldsContext)</b>
<b class="nc"><i>1578</i>&nbsp;                &amp;&amp; Objects.equals(from, other.from)</b>
<b class="nc"><i>1579</i>&nbsp;                &amp;&amp; Objects.equals(highlightBuilder, other.highlightBuilder)</b>
<b class="nc"><i>1580</i>&nbsp;                &amp;&amp; Objects.equals(indexBoosts, other.indexBoosts)</b>
<b class="nc"><i>1581</i>&nbsp;                &amp;&amp; Objects.equals(minScore, other.minScore)</b>
<b class="nc"><i>1582</i>&nbsp;                &amp;&amp; Objects.equals(postQueryBuilder, other.postQueryBuilder)</b>
<b class="nc"><i>1583</i>&nbsp;                &amp;&amp; Objects.equals(queryBuilder, other.queryBuilder)</b>
<b class="nc"><i>1584</i>&nbsp;                &amp;&amp; Objects.equals(rescoreBuilders, other.rescoreBuilders)</b>
<b class="nc"><i>1585</i>&nbsp;                &amp;&amp; Objects.equals(scriptFields, other.scriptFields)</b>
<b class="nc"><i>1586</i>&nbsp;                &amp;&amp; Objects.equals(size, other.size)</b>
<b class="nc"><i>1587</i>&nbsp;                &amp;&amp; Objects.equals(sorts, other.sorts)</b>
<b class="nc"><i>1588</i>&nbsp;                &amp;&amp; Objects.equals(searchAfterBuilder, other.searchAfterBuilder)</b>
<b class="nc"><i>1589</i>&nbsp;                &amp;&amp; Objects.equals(sliceBuilder, other.sliceBuilder)</b>
<b class="nc"><i>1590</i>&nbsp;                &amp;&amp; Objects.equals(stats, other.stats)</b>
<b class="nc"><i>1591</i>&nbsp;                &amp;&amp; Objects.equals(suggestBuilder, other.suggestBuilder)</b>
<b class="nc"><i>1592</i>&nbsp;                &amp;&amp; Objects.equals(terminateAfter, other.terminateAfter)</b>
<b class="nc"><i>1593</i>&nbsp;                &amp;&amp; Objects.equals(timeout, other.timeout)</b>
<b class="nc"><i>1594</i>&nbsp;                &amp;&amp; Objects.equals(trackScores, other.trackScores)</b>
<b class="nc"><i>1595</i>&nbsp;                &amp;&amp; Objects.equals(version, other.version)</b>
<b class="nc"><i>1596</i>&nbsp;                &amp;&amp; Objects.equals(seqNoAndPrimaryTerm, other.seqNoAndPrimaryTerm)</b>
<b class="nc"><i>1597</i>&nbsp;                &amp;&amp; Objects.equals(profile, other.profile)</b>
<b class="nc"><i>1598</i>&nbsp;                &amp;&amp; Objects.equals(extBuilders, other.extBuilders)</b>
<b class="nc"><i>1599</i>&nbsp;                &amp;&amp; Objects.equals(collapse, other.collapse)</b>
<b class="nc"><i>1600</i>&nbsp;                &amp;&amp; Objects.equals(trackTotalHitsUpTo, other.trackTotalHitsUpTo);</b>
<i>1601</i>&nbsp;    }
<i>1602</i>&nbsp;
<i>1603</i>&nbsp;    @Override
<i>1604</i>&nbsp;    public String toString() {
<b class="nc"><i>1605</i>&nbsp;        return toString(EMPTY_PARAMS);</b>
<i>1606</i>&nbsp;    }
<i>1607</i>&nbsp;
<i>1608</i>&nbsp;    public String toString(Params params) {
<i>1609</i>&nbsp;        try {
<b class="nc"><i>1610</i>&nbsp;            return XContentHelper.toXContent(this, XContentType.JSON, params, true).utf8ToString();</b>
<b class="nc"><i>1611</i>&nbsp;        } catch (IOException e) {</b>
<b class="nc"><i>1612</i>&nbsp;            throw new ElasticsearchException(e);</b>
<i>1613</i>&nbsp;        }
<i>1614</i>&nbsp;    }
<i>1615</i>&nbsp;}
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2020-02-09 18:46</div>
</div>
</body>
</html>
